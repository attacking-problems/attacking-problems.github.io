<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.9">
<meta name="author" content="Barry Wittman, Tim Korb, Aditya Mathur">
<title>Start Concurrent: A Gentle Introduction to Concurrent Programming</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Start Concurrent: A Gentle Introduction to Concurrent Programming</h1>
<div class="details">
<span id="author" class="author">Barry Wittman</span><br>
<span id="email" class="email"><a href="mailto:wittman1@otterbein.edu">wittman1@otterbein.edu</a></span><br>
<span id="author2" class="author">Tim Korb</span><br>
<span id="email2" class="email"><a href="mailto:jtk@purdue.edu">jtk@purdue.edu</a></span><br>
<span id="author3" class="author">Aditya Mathur</span><br>
<span id="email3" class="email"><a href="mailto:apm@purdue.edu">apm@purdue.edu</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html#ch01-computer-basics">1. Computer Basics</a>
<ul class="sectlevel2">
<li><a href="index.html#_problem_buying_a_computer">1.1. Problem: Buying a computer</a></li>
<li><a href="index.html#_concepts_hardware_and_software">1.2. Concepts: Hardware and software</a></li>
<li><a href="index.html#_syntax_data_representation">1.3. Syntax: Data representation</a></li>
<li><a href="index.html#_solution_buying_a_computer">1.4. Solution: Buying a computer</a></li>
<li><a href="index.html#_summary">1.5. Summary</a></li>
<li><a href="index.html#_exercises">1.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap1.html#ch02-intro">2. Problem Solving and Programming</a>
<ul class="sectlevel2">
<li><a href="chap1.html#_problem_how_to_solve_problems">2.1. Problem: How to solve problems</a></li>
<li><a href="chap1.html#_concepts_developing_software">2.2. Concepts: Developing software</a></li>
<li><a href="chap1.html#_syntax_java_basics">2.3. Syntax: Java basics</a></li>
<li><a href="chap1.html#_solution_how_to_solve_problems">2.4. Solution: How to solve problems</a></li>
<li><a href="chap1.html#_concurrency_solving_problems_in_parallel">2.5. Concurrency: Solving problems in parallel</a></li>
<li><a href="chap1.html#_summary_2">2.6. Summary</a></li>
<li><a href="chap1.html#_exercises_2">2.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap2.html#ch03-strings-primitive-types">3. Primitive Types and Strings</a>
<ul class="sectlevel2">
<li><a href="chap2.html#_problem_college_cost_calculator">3.1. Problem: College cost calculator</a></li>
<li><a href="chap2.html#_concepts_types">3.2. Concepts: Types</a></li>
<li><a href="chap2.html#_syntax_types_in_java">3.3. Syntax: Types in Java</a></li>
<li><a href="chap2.html#_syntax_useful_libraries">3.4. Syntax: Useful libraries</a></li>
<li><a href="chap2.html#_solution_college_cost_calculator">3.5. Solution: College cost calculator</a></li>
<li><a href="chap2.html#_concurrency_expressions">3.6. Concurrency: Expressions</a></li>
<li><a href="chap2.html#_summary_3">3.7. Summary</a></li>
<li><a href="chap2.html#_exercises_3">3.8. Exercises</a></li>
</ul>
</li>
<li><a href="chap3.html#ch04-selection">4. Selection</a>
<ul class="sectlevel2">
<li><a href="chap3.html#_problem_monty_hall_simulation">4.1. Problem: Monty Hall simulation</a></li>
<li><a href="chap3.html#_concepts_choosing_between_options">4.2. Concepts: Choosing between options</a></li>
<li><a href="chap3.html#_syntax_selection_in_java">4.3. Syntax: Selection in Java</a></li>
<li><a href="chap3.html#_solution_monty_hall">4.4. Solution: Monty Hall</a></li>
<li><a href="chap3.html#_concurrency_selection">4.5. Concurrency: Selection</a></li>
<li><a href="chap3.html#_exercises_4">4.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap4.html#ch05-repetition">5. Repetition</a>
<ul class="sectlevel2">
<li><a href="chap4.html#_problem_dna_searching">5.1. Problem: DNA searching</a></li>
<li><a href="chap4.html#_concepts_repetition">5.2. Concepts: Repetition</a></li>
<li><a href="chap4.html#_syntax_loops_in_java">5.3. Syntax: Loops in Java</a></li>
<li><a href="chap4.html#_solution_dna_searching">5.4. Solution: DNA searching</a></li>
<li><a href="chap4.html#_concurrency_loops">5.5. Concurrency: Loops</a></li>
<li><a href="chap4.html#_exercises_5">5.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap5.html#ch06-arrays">6. Arrays</a>
<ul class="sectlevel2">
<li><a href="chap5.html#_introduction">6.1. Introduction</a></li>
<li><a href="chap5.html#_problem_game_of_life">6.2. Problem: Game of Life</a></li>
<li><a href="chap5.html#_concepts_lists_of_data">6.3. Concepts: Lists of data</a></li>
<li><a href="chap5.html#_syntax_arrays_in_java">6.4. Syntax: Arrays in Java</a></li>
<li><a href="chap5.html#_examples_array_usage">6.5. Examples: Array usage</a></li>
<li><a href="chap5.html#_concepts_multidimensional_lists">6.6. Concepts: Multidimensional lists</a></li>
<li><a href="chap5.html#_syntax_advanced_arrays_in_java">6.7. Syntax: Advanced arrays in Java</a></li>
<li><a href="chap5.html#_examples_two_dimensional_arrays">6.8. Examples: Two-dimensional arrays</a></li>
<li><a href="chap5.html#_advanced_special_array_tools_in_java">6.9. Advanced: Special array tools in Java</a></li>
<li><a href="chap5.html#_solution_game_of_life">6.10. Solution: Game of Life</a></li>
<li><a href="chap5.html#_concurrency_arrays">6.11. Concurrency: Arrays</a></li>
<li><a href="chap5.html#_exercises_6">6.12. Exercises</a></li>
</ul>
</li>
<li><a href="chap6.html#ch07-gui-basics">7. Simple Graphical User Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap6.html#_problem_codon_extractor">7.1. Problem: Codon extractor</a></li>
<li><a href="chap6.html#GUIBasicsIntroductionSection">7.2. Concepts: User interaction</a></li>
<li><a href="chap6.html#_syntax_dialogs_and_the_joptionpane_class">7.3. Syntax: Dialogs and the <code>JOptionPane</code> class</a></li>
<li><a href="chap6.html#_solution_codon_extractor">7.4. Solution: Codon extractor</a></li>
<li><a href="chap6.html#_concurrency_simple_guis">7.5. Concurrency: Simple GUIs</a></li>
<li><a href="chap6.html#_summary_4">7.6. Summary</a></li>
<li><a href="chap6.html#_exercises_7">7.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap7.html#ch08-methods">8. Methods</a>
<ul class="sectlevel2">
<li><a href="chap7.html#_problem_three_card_poker">8.1. Problem: Three card poker</a></li>
<li><a href="chap7.html#_concepts_dividing_work_into_segments">8.2. Concepts: Dividing work into segments</a></li>
<li><a href="chap7.html#_syntax_methods">8.3. Syntax: Methods</a></li>
<li><a href="chap7.html#_examples_defining_methods">8.4. Examples: Defining methods</a></li>
<li><a href="chap7.html#_solution_three_card_poker">8.5. Solution: Three card poker</a></li>
<li><a href="chap7.html#_concurrency_methods">8.6. Concurrency: Methods</a></li>
<li><a href="chap7.html#_exercises_8">8.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap8.html#ch09-classes">9. Classes</a>
<ul class="sectlevel2">
<li><a href="chap8.html#_problem_nested_expressions">9.1. Problem: Nested expressions</a></li>
<li><a href="chap8.html#_concepts_object_oriented_programming">9.2. Concepts: Object-oriented programming</a></li>
<li><a href="chap8.html#_syntax_classes_in_java">9.3. Syntax: Classes in Java</a></li>
<li><a href="chap8.html#_examples_classes">9.4. Examples: Classes</a></li>
<li><a href="chap8.html#_advanced_nested_classes">9.5. Advanced: Nested classes</a></li>
<li><a href="chap8.html#_solution_nested_expressions">9.6. Solution: Nested expressions</a></li>
<li><a href="chap8.html#_concurrency_objects">9.7. Concurrency: Objects</a></li>
<li><a href="chap8.html#_exercises_9">9.8. Exercises</a></li>
</ul>
</li>
<li><a href="chap9.html#ch10-interfaces">10. Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap9.html#_problem_sort_it_out">10.1. Problem: Sort it out</a></li>
<li><a href="chap9.html#_concepts_making_a_promise">10.2. Concepts: Making a promise</a></li>
<li><a href="chap9.html#_syntax_interfaces">10.3. Syntax: Interfaces</a></li>
<li><a href="chap9.html#_advanced_local_and_anonymous_classes">10.4. Advanced: Local and anonymous classes</a></li>
<li><a href="chap9.html#_solution_sort_it_out">10.5. Solution: Sort it out</a></li>
<li><a href="chap9.html#_concurrency_interfaces">10.6. Concurrency: Interfaces</a></li>
<li><a href="chap9.html#_exercises_10">10.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap10.html#ch11-inheritance">11. Inheritance</a>
<ul class="sectlevel2">
<li><a href="chap10.html#_problem_boolean_circuits">11.1. Problem: Boolean circuits</a></li>
<li><a href="chap10.html#_concepts_refining_classes">11.2. Concepts: Refining classes</a></li>
<li><a href="chap10.html#_syntax_inheritance_in_java">11.3. Syntax: Inheritance in Java</a></li>
<li><a href="chap10.html#_examples_problem_solving_with_inheritance">11.4. Examples: Problem solving with inheritance</a></li>
<li><a href="chap10.html#_solution_boolean_circuits">11.5. Solution: Boolean circuits</a></li>
<li><a href="chap10.html#_concurrency_inheritance">11.6. Concurrency: Inheritance</a></li>
<li><a href="chap10.html#_exercises_11">11.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap11.html#ch12-exceptions">12. Exceptions</a>
<ul class="sectlevel2">
<li><a href="chap11.html#_problem_bank_burglary">12.1. Problem: Bank burglary</a></li>
<li><a href="chap11.html#_concepts_error_handling">12.2. Concepts: Error handling</a></li>
<li><a href="chap11.html#_syntax_exceptions_in_java">12.3. Syntax: Exceptions in Java</a></li>
<li><a href="chap11.html#_solution_bank_burglary">12.4. Solution: Bank burglary</a></li>
<li><a href="chap11.html#_concurrency_exceptions">12.5. Concurrency: Exceptions</a></li>
<li><a href="chap11.html#_exercises_12">12.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap12.html#ch13-concurrency">13. Concurrent Programming</a>
<ul class="sectlevel2">
<li><a href="chap12.html#_introduction_2">13.1. Introduction</a></li>
<li><a href="chap12.html#_problem_deadly_virus">13.2. Problem: Deadly virus</a></li>
<li><a href="chap12.html#_concepts_splitting_up_work">13.3. Concepts: Splitting up work</a></li>
<li><a href="chap12.html#_syntax_threads_in_java">13.4. Syntax: Threads in Java</a></li>
<li><a href="chap12.html#_examples_concurrency_and_speedup">13.5. Examples: Concurrency and speedup</a></li>
<li><a href="chap12.html#_concepts_thread_scheduling">13.6. Concepts: Thread scheduling</a></li>
<li><a href="chap12.html#_syntax_thread_states">13.7. Syntax: Thread states</a></li>
<li><a href="chap12.html#_solution_deadly_virus">13.8. Solution: Deadly virus</a></li>
<li><a href="chap12.html#_summary_5">13.9. Summary</a></li>
<li><a href="chap12.html#_exercises_13">13.10. Exercises</a></li>
</ul>
</li>
<li><a href="chap13.html#ch14-synchronization">14. Synchronization</a>
<ul class="sectlevel2">
<li><a href="chap13.html#_introduction_3">14.1. Introduction</a></li>
<li><a href="chap13.html#_problem_dining_philosophers">14.2. Problem: Dining philosophers</a></li>
<li><a href="chap13.html#_concepts_thread_interaction">14.3. Concepts: Thread interaction</a></li>
<li><a href="chap13.html#_syntax_thread_synchronization">14.4. Syntax: Thread synchronization</a></li>
<li><a href="chap13.html#_pitfalls_synchronization_challenges">14.5. Pitfalls: Synchronization challenges</a></li>
<li><a href="chap13.html#_solution_dining_philosophers">14.6. Solution: Dining philosophers</a></li>
<li><a href="chap13.html#_exercises_14">14.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap14.html#ch15-gui">15. Constructing Graphical User Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap14.html#_problem_math_applet">15.1. Problem: Math applet</a></li>
<li><a href="chap14.html#_concepts_graphical_user_interfaces">15.2. Concepts: Graphical user interfaces</a></li>
<li><a href="chap14.html#_syntax_guis_in_java">15.3. Syntax: GUIs in Java</a></li>
<li><a href="chap14.html#_solution_math_applet">15.4. Solution: Math applet</a></li>
<li><a href="chap14.html#_concurrency_guis">15.5. Concurrency: GUIs</a></li>
<li><a href="chap14.html#_summary_6">15.6. Summary</a></li>
<li><a href="chap14.html#_exercises_15">15.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap15.html#ch16-testing-and-debugging">16. Testing and Debugging</a>
<ul class="sectlevel2">
<li><a href="chap15.html#_fixing_bugs">16.1. Fixing bugs</a></li>
<li><a href="chap15.html#_concepts_approaches_to_debugging">16.2. Concepts: Approaches to debugging</a></li>
<li><a href="chap15.html#_syntax_java_debugging_tools">16.3. Syntax: Java debugging tools</a></li>
<li><a href="chap15.html#_concurrency_parallel_bugs">16.4. Concurrency: Parallel bugs</a></li>
<li><a href="chap15.html#_finding_and_avoiding_bugs">16.5. Finding and avoiding bugs</a></li>
<li><a href="chap15.html#_concepts_design_implementation_and_testing">16.6. Concepts: Design, implementation, and testing</a></li>
<li><a href="chap15.html#_syntax_java_testing_tools">16.7. Syntax: Java testing tools</a></li>
<li><a href="chap15.html#_concurrency_testing_tools">16.8. Concurrency: Testing tools</a></li>
<li><a href="chap15.html#_examples_testing_a_class">16.9. Examples: Testing a class</a></li>
<li><a href="chap15.html#_exercises_16">16.10. Exercises</a></li>
</ul>
</li>
<li><a href="chap16.html#ch17-polymorphism">17. Polymorphism</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_problem_banking_account_with_a_vengeance">17.1. Problem: Banking account with a vengeance</a></li>
<li><a href="chap16.html#_concepts_polymorphism">17.2. Concepts: Polymorphism</a></li>
<li><a href="chap16.html#_syntax_inheritance_tools_in_java">17.3. Syntax: Inheritance tools in Java</a></li>
<li><a href="chap16.html#_solution_banking_account_with_a_vengeance">17.4. Solution: Banking account with a vengeance</a></li>
<li><a href="chap16.html#_concurrency_atomic_libraries">17.5. Concurrency: Atomic libraries</a></li>
<li><a href="chap16.html#_exercises_17">17.6. Exercises</a></li>
</ul>
</li>
<li><a href="#ch18-dynamic-data-structures">18. Dynamic Data Structures</a>
<ul class="sectlevel2">
<li><a href="#_problem_infix_conversion">18.1. Problem: Infix conversion</a></li>
<li><a href="#_concepts_dynamic_data_structures">18.2. Concepts: Dynamic data structures</a></li>
<li><a href="#_syntax_dynamic_arrays_and_linked_lists">18.3. Syntax: Dynamic arrays and linked lists</a></li>
<li><a href="#_syntax_abstract_data_types_adt">18.4. Syntax: Abstract data types (ADT)</a></li>
<li><a href="#_advanced_generic_data_structures">18.5. Advanced: Generic data structures</a></li>
<li><a href="#_solution_infix_conversion">18.6. Solution: Infix conversion</a></li>
<li><a href="#_concurrency_linked_lists_and_thread_safety">18.7. Concurrency: Linked lists and thread safety</a></li>
<li><a href="#_concurrency_thread_safe_libraries">18.8. Concurrency: Thread-safe libraries</a></li>
<li><a href="#_exercises_18">18.9. Exercises</a></li>
</ul>
</li>
<li><a href="chap18.html#ch19-recursion">19. Recursion</a>
<ul class="sectlevel2">
<li><a href="chap18.html#_problem_maze_of_doom">19.1. Problem: Maze of doom</a></li>
<li><a href="chap18.html#_concepts_recursive_problem_solving">19.2. Concepts: Recursive problem solving</a></li>
<li><a href="chap18.html#_syntax_recursive_methods">19.3. Syntax: Recursive methods</a></li>
<li><a href="chap18.html#_syntax_recursive_data_structures">19.4. Syntax: Recursive data structures</a></li>
<li><a href="chap18.html#_solution_maze_of_doom">19.5. Solution: Maze of doom</a></li>
<li><a href="chap18.html#_concurrency_futures">19.6. Concurrency: Futures</a></li>
<li><a href="chap18.html#_exercises_19">19.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap19.html#ch20-file-io">20. File I/O</a>
<ul class="sectlevel2">
<li><a href="chap19.html#_problem_a_picture_is_worth_1000_bytes">20.1. Problem: A picture is worth 1,000 bytes</a></li>
<li><a href="chap19.html#_concepts_file_io">20.2. Concepts: File I/O</a></li>
<li><a href="chap19.html#_syntax_file_operations_in_java">20.3. Syntax: File operations in Java</a></li>
<li><a href="chap19.html#_examples_file_examples">20.4. Examples: File examples</a></li>
<li><a href="chap19.html#_solution_a_picture_is_worth_1000_bytes">20.5. Solution: A picture is worth 1,000 bytes</a></li>
<li><a href="chap19.html#_concurrency_file_io">20.6. Concurrency: File I/O</a></li>
<li><a href="chap19.html#_exercises_20">20.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap20.html#ch21-network-communication">21. Network Communication</a>
<ul class="sectlevel2">
<li><a href="chap20.html#_problem_web_server">21.1. Problem: Web server</a></li>
<li><a href="chap20.html#_concepts_tcpip_communication">21.2. Concepts: TCP/IP communication</a></li>
<li><a href="chap20.html#_syntax_networking_in_java">21.3. Syntax: Networking in Java</a></li>
<li><a href="chap20.html#_solution_web_server">21.4. Solution: Web server</a></li>
<li><a href="chap20.html#_concurrency_networking">21.5. Concurrency: Networking</a></li>
<li><a href="chap20.html#_exercises_21">21.6. Exercises</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content"><div class="sect1">
<h2 id="ch18-dynamic-data-structures">18. Dynamic Data Structures</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Algorithms + Data Structures = Programs</p>
</div>
</blockquote>
<div class="attribution">
— Niklaus Wirth
</div>
</div>
<div class="sect2">
<h3 id="_problem_infix_conversion">18.1. Problem: Infix conversion</h3>
<div class="paragraph">
<p>If a math teacher writes the expression 1 + 7 × 8 -
6 × (4 + 5) ÷ 3 on the blackboard and asks a group of 10-year-old children to solve it, different children may give different answers.
The difficulty is that the children may not understand the order of
operations. Modern graphing calculators and many computer programs can,
of course, evaluate such expressions correctly, but how do they do it?
You intuitively grasp order of operations (left to right, multiplication
and division take higher precedence than addition and subtraction), but
encoding that intuition into a computer program takes effort.</p>
</div>
<div class="paragraph">
<p>One way a computer scientist might approach this problem is to turn the
mathematical expression from one that’s difficult to evaluate to one
that’s easy. The normal style of writing mathematical expressions is
called <em>infix notation</em>, because the operators are written in between
the operands they are used on. An easier notation for automatic
evaluation is called <em>postfix notation</em>, because an operator is placed
after the operands it works on. The following table gives
a few examples of expressions written in both infix and postfix
notation.</p>
</div>
<table class="tableblock frame-all grid-all fit-content center">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Infix</th>
<th class="tableblock halign-left valign-top">Postfix</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 + 7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 7 +</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4 * 2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4 2 *</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 + 9 * 2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 9 2 * +</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(1 + 9) * 2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 9 + 2 *</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Although infix notation is probably more familiar to you, postfix
notation has the benefit of exactly specifying the order of operations
without using any precedence rules and without needing parentheses to
clarify. To understand how to compute an expression in postfix notation,
we rely on the idea of a stack, which we first introduces in
<a href="chap8.html#ch09-classes">Chapter 9</a> and examine in much greater depth here.</p>
</div>
<div class="paragraph">
<p>Recall that a stack has three operations: <em>push</em>, <em>pop</em>, and <em>top</em>. It
works like a stack of physical objects. The push operation places an
object on the top, the pop operation removes an item from the top, and
the top operation tells you what is at the top of the stack.</p>
</div>
<div class="paragraph">
<p>Using a stack, the postfix evaluation rules are easy. Scan the
expression from left to right, if you see an operand (a number, in our
case), put it on the stack. If you see an operator, pop the last two
operands off the stack and use the operator on them. Then, push the
result back on the stack. When you run out of input, the value at the
top of the stack is your answer.</p>
</div>
<div class="paragraph">
<p>For example, with <code>1 9 2 * +</code>, all three operands are pushed onto the
stack. Then, the <code>*</code> is read, and so <code>2</code> and <code>9</code> is popped off the stack
and multiplied. The result <code>18</code> is pushed back on the stack. Then, the
<code>+</code> is read, and <code>18</code> and <code>1</code> is popped off the stack and summed,
resulting in <code>19</code>, which is pushed back on the stack and is the final
answer.</p>
</div>
<div class="paragraph">
<p>Our problem, however, is not to evaluate an expression in postfix
notation but to convert an expression in infix notation to postfix
notation. Again, the concept of a stack is useful. To do the conversion,
we initialize a stack and scan through the input in infix notation. As
we scan through the input, we do one of four things depending on which
of the four possible inputs we see:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operand</dt>
<dd>
<p>Simply copy the operand to the postfix output.</p>
</dd>
<dt class="hdlist1">Operator</dt>
<dd>
<p>If the stack is empty, push the operator onto the stack. If the stack
is not empty and the operator at the top of the stack has the same or
greater precedence than our new operator, put the top operator into
our postfix output and pop the stack. Continue this process as long as
the top operator has the same or greater precedence compared to our
new operator and the stack is not empty. Finally, push the new
operator onto the stack.</p>
</dd>
<dt class="hdlist1">Left Parenthesis</dt>
<dd>
<p>Push the left parenthesis onto the stack.</p>
</dd>
<dt class="hdlist1">Right Parenthesis</dt>
<dd>
<p>Pop everything off the stack and add it to the output until you find a
left parenthesis in the stack. Then pop the left parenthesis.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Precedence comes from order of operations: <code>*</code> and <code>/</code> have high
precedence and <code>+</code> and <code>-</code> have low precedence. When you encounter it on
the stack, treat <code>(</code> as if it has even lower precedence than <code>+</code> and
<code>-</code>. A right parenthesis should never appear on the stack.</p>
</div>
<div class="paragraph">
<p>Following this algorithm, we are able to write a program that converts
infix notation to postfix notation. We further restrict our problem to
the case when the only operands are positive integers in the range
[0, 9]. Since each is a single character, parsing the
input is much easier. The same ideas for postfix conversion holds no
matter how the input is formatted, but parsing arbitrarily formatted
numbers is a difficult problem in its own right. This restriction also
makes spaces unnecessary.</p>
</div>
<div class="paragraph">
<p>To solve the infix conversion problem, we need to create a stack data
structure whose elements are terms from an infix expression, where a
term is an operator, operand, or a parenthesis. We created a stack to
solve the nesting expression problem in <a href="chap8.html#_problem_nested_expressions">Section 9.1</a>, but we explore stacks in this chapter as one of many
different kinds of dynamic data structure.</p>
</div>
</div>
<div class="sect2">
<h3 id="_concepts_dynamic_data_structures">18.2. Concepts: Dynamic data structures</h3>
<div class="paragraph">
<p>By now you have seen several ways to organize data in your programs. For
example, you have used arrays to store a sequence of values and class
definitions to store (and operate on) collections of related values.
These data structures have the property that they are <em>static</em> in size:
Once allocated, they do not grow as the program runs. If you allocate an
array to store 100 integers, you’ll get an error if you try to store 101
integers into it.</p>
</div>
<div class="paragraph">
<p>In this chapter, we examine <em>dynamic</em> data structures: As more data is
read or processed, these data structures grow and shrink in memory to
store what is needed. The stack used to solve the nesting expressions
problem from <a href="chap8.html#ch09-classes">Chapter 9</a> is not actually a dynamic data
structure since it is defined with a fixed maximum size. In this
chapter, we implement a true stack as well as many other kinds of
dynamic data structures.</p>
</div>
<div class="sect3">
<h4 id="_dynamic_arrays">18.2.1. Dynamic arrays</h4>
<div class="paragraph">
<p>There are two broad classes of dynamic data structures we examine here.
The first kind are based on arrays that grow and shrink. Dynamic arrays
allow for fast access to individual elements in the data structure. One
drawback of dynamic arrays is that the array that stores that data has a
fixed amount of space. When too many elements are added, a new array has
to be reallocated and all the original elements copied over.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="chapters/18-dynamic-data-structures/images/dynamicinsertion.svg" alt="dynamicinsertion" width="80%">
</div>
<div class="title">Figure 18.1 Insertion into full dynamic array requiring reallocation. Even if the array wasn’t full, all values after <code>14</code> would need to be moved back to insert <code>17</code> in order.</div>
</div>
<div class="paragraph">
<p>Another drawback of dynamic arrays is that they are poorly suited for
insertion or deletion of elements in the middle of the array. When an
element is inserted, each element after it must be moved back one
position. Likewise, when an element is deleted, all of the elements
after it must be moved forward one position. Thus, insertions and
deletions at the end of a dynamic array are usually efficient, but
insertions and deletions in the middle are very time consuming.</p>
</div>
</div>
<div class="sect3">
<h4 id="_linked_lists">18.2.2. Linked lists</h4>
<div class="paragraph">
<p>The second kind of dynamic data structure is based on objects that link
to (or reference) other objects. The simplest form of such a data type
is a <em>linked list</em>. A linked list is a data structure made up of a
sequence of objects. Each object contains some data value (such as a
<code>String</code>) and a <em>link</em> to the next object in the sequence.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="chapters/18-dynamic-data-structures/images/linkedlist.svg" alt="linkedlist" width="100%">
</div>
<div class="title">Figure 18.2 Visualization of a linked list.</div>
</div>
<div class="paragraph">
<p>Linked lists are flexible because they have no preset size. Whenever a
new element is needed, it can be created and linked into the list.
Unfortunately, they can be slow if you need to access arbitrary elements
in the list. The only way to reach an element in the list is to walk
from element to element until you find what you’re looking for. If the
element is at the beginning (or the end) of the list, this process can
be quick. If the element is in the middle, there is no fast way to get
there.</p>
</div>
<div class="paragraph">
<p>Linked lists work well when inserting new elements at arbitrary
locations in the list. Unlike arrays, they are not implemented as a
contiguous block of memory. Linking a new element into the middle of the
list automatically creates the correct relationship among elements, and
there is no need to move all the elements after an insertion.</p>
</div>
<div class="paragraph">
<p>Among their downsides is the memory overhead of linked lists. Because a
new object must be allocated for each element in the list, which must
include a reference to the next element. Consequently, using a linked
list to solve a problem usually take more memory than an equivalent
dynamic array solution.</p>
</div>
<div class="paragraph">
<p>It turns out that either dynamic arrays or linked lists can be used to
create an efficient solution to the infix conversion problem defined at
the beginning of the chapter.</p>
</div>
</div>
<div class="sect3">
<h4 id="_abstract_data_types">18.2.3. Abstract data types</h4>
<div class="paragraph">
<p>The fact that dynamic arrays and linked lists can be used to solve
similar problems points out that we may often be more interested in the
<strong>capabilities</strong> of a data structure rather than its implementation.</p>
</div>
<div class="paragraph">
<p>An <em>abstract data type</em> (ADT) is a set of operations that can be applied
to a set of data values with well-defined results that are independent
of any particular implementation. In other words, it is a list of things
that a data type can do (or have done to it).</p>
</div>
<div class="paragraph">
<p>A stack is a great example of an ADT. A stack needs to be able to push a
value, pop a value, and tell us what value is on top. The internal
workings of the stack are irrelevant (as long as they are efficient). It
is possible to use either a dynamic array or a linked list to implement
a stack ADT. A queue is another ADT we discuss in
<a href="#_syntax_abstract_data_types_adt">Section 18.4</a>, but there are many other
useful ADTs.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_dynamic_arrays_and_linked_lists">18.3. Syntax: Dynamic arrays and linked lists</h3>
<div class="sect3">
<h4 id="_dynamic_arrays_2">18.3.1. Dynamic arrays</h4>
<div class="paragraph">
<p>Suppose you are faced with the problem of reading a list of names from a
file, sorting them into alphabetical order, and printing them out. You
have already looked at simple sorting algorithms to handle the sorting
part, or you could use the Java <code>Arrays.sort()</code> method. In previous
problems when you needed to use an array for storing items, you knew in
advance how many (or a maximum of how many) items you would need to
store. In this new problem, the number of names in the input file is
unspecified, so you must allow an arbitrary number to be handled.</p>
</div>
<div class="paragraph">
<p>One approach is to make a guess at how many names are in the input file
and allocate an array of that size. If your guess is too small, and you
don’t check array accesses, you’ll cause an exception once you have
filled the array and try to store the next name into the index one past
the last. If your guess is too large, you could be wasting a significant
amount of storage space.</p>
</div>
<div class="paragraph">
<p>Our first solution to the problem of dealing with dynamic or unknown
amounts of data is to watch our array accesses and expand the array as
necessary during processing. (It is also possible to contract an array
once you determine that the array has more space than needed.)</p>
</div>
<div class="sect4">
<h5 id="_a_simple_solution">A simple solution</h5>
<div class="paragraph">
<p><a href="#ReadIntoFixedArrayProgram">Program 18.1</a> allocates an array of 10 strings
and reads a list of names from standard input until it reaches the end
of the file, storing each name in successive array locations. If the
number of names in the input is larger than the size of the array, it
generates an exception.</p>
</div>
<div class="paragraph">
<p>Since programs that generate uncaught exceptions are, in general, a bad
idea, our first change to this program should be either to catch the
exception or check the index before storing the name in the array. In
either case, we would then take some action that is more user friendly
than generating an exception, perhaps simply printing an explanatory
message before exiting.</p>
</div>
<div id="ReadIntoFixedArrayProgram" class="listingblock">
<div class="title">Program 18.1 Reads names into an array, sort, and print. If there are more than 10 lines in the input, an exception is generated.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReadIntoFixedArray</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

        <span class="k">while</span><span class="o">(</span> <span class="n">in</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">names</span><span class="o">[</span><span class="n">n</span><span class="o">++]</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>

        <span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">names</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>

        <span class="k">for</span><span class="o">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">names</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Our second change is to take a recovery action that allows the program
to proceed. What went wrong? We made a guess of the input size,
allocated an array of that size, but our guess was too small. We could
start over again (modify the code to initially allocate a larger array,
recompile, and re-run the program), but that option may not be available
to us if the program has been distributed to users around the world.
Instead, we fix the problem on the fly by allocating a larger array,
copying the old array into the new array, and continuing.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#fixedArrayExceptionExercise">Exercise 18.3</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#ReadAndGrowArrayProgram">Program 18.2</a> begins like the previous program by
allocating a fixed array.</p>
</div>
<div id="ReadAndGrowArrayProgram" class="listingblock">
<div class="title">Program 18.2 Reads names into an array, enlarging the array as necessary.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReadAndGrowArray</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">names</span><span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">catch</span><span class="o">(</span> <span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span> <span class="o">)</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
                <span class="n">names</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">names</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">names</span><span class="o">.</span><span class="na">length</span><span class="o">*</span><span class="mi">2</span><span class="o">);</span> <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="n">names</span><span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">n</span><span class="o">++;</span>
        <span class="o">}</span>

        <span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">names</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">names</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>At this point, it now catches the <code>ArrayOutOfBoundsException</code> if there isn’t enough space for another name in the array.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>catch</code> clause allocates a new array, twice the size of the original (current) array, copies the existing array into it, and replaces the reference to the current array with a reference to the new array.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that it was necessary to refactor the code in
<a href="#ReadIntoFixedArrayProgram">Program 18.1</a> slightly: Add the <code>name</code> variable
to hold the temporary result of reading the input line, and move the
counter increment to outside the <code>try</code>-<code>catch</code> block.</p>
</div>
<div class="paragraph">
<p>Can this new, improved program still fail? Yes, but only for <strong>very
large</strong> input, in the case when the Java virtual machine runs out of
memory when doubling the size of the array.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#alternateGrowArrayExercise">Exercise 18.4</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>A potentially more serious problem is the way we set <code>names</code> to point at
a new array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="n">names</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">names</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">names</span><span class="o">.</span><span class="na">length</span><span class="o">*</span><span class="mi">2</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This line works because we know the only variable that references the
array is <code>names</code>. If other variables referenced that array, they would
continue to reference the old, smaller, and now out-of-date version of
the <code>names</code> array. <a href="#figure-dynamicproblems">Figure 18.3</a> gives an example of
this problem.</p>
</div>
<div id="figure-dynamicproblems" class="imageblock">
<div class="content">
<img src="chapters/18-dynamic-data-structures/images/dynamicproblems.svg" alt="dynamicproblems" width="100%">
</div>
<div class="title">Figure 18.3 A poorly designed dynamic array implementation. (a) Both <code>array1</code> and <code>array2</code> begin pointing at the same array. (b) A new array has been allocated, and <code>42</code> has been added to it. <code>array1</code> has been updated to point at the new array, but <code>array2</code> still points at the original.</div>
</div>
</div>
<div class="sect4">
<h5 id="_a_more_complete_solution">A more complete solution</h5>
<div class="paragraph">
<p>The problem of updating variables that reference the dynamic array is a
serious issue in large programs. It may not be enough to allocate a
larger array and assign the new reference to only one variable. There
may be hundreds of variables (or objects) that reference the original
array.</p>
</div>
<div class="paragraph">
<p>A solution to this problem is to create a new class whose objects
contain the array as a private field. References to the array are then
mediated, as usual, via accessor methods, which always refers to the
same version of the array. <a href="#DynamicArrayProgram">Program 18.3</a> is a simple
implementation of a dynamic array class. This class maintains an
internal array of <code>String</code> objects, which it extends whenever a call to
<code>set()</code> tries to write a new element just past the end of the array.</p>
</div>
<div id="DynamicArrayProgram" class="listingblock">
<div class="title">Program 18.3 Class to manage a dynamic array. This array grows by doubling when more space is needed.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DynamicArray</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="n">String</span> <span class="n">string</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">strings</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span>
                                         <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">*</span><span class="mi">2</span><span class="o">);</span>
        <span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">string</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">sort</span><span class="o">(</span><span class="kt">int</span> <span class="n">first</span><span class="o">,</span> <span class="kt">int</span> <span class="n">last</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">strings</span><span class="o">,</span> <span class="n">first</span><span class="o">,</span> <span class="n">last</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>set()</code> and <code>sort()</code> methods are both <code>synchronized</code> in
case this class is used by multiple threads simultaneously.
<a href="#testUnsynchronizedDynamicArrayExercise">Exercise 18.12</a> explores the need to
synchronize these methods in the presence of multiple threads.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#shrinkingDynamicArrayExercise">Exercise 18.9</a><br>
<a href="#testUnsynchronizedDynamicArrayExercise">Exercise 18.12</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p><a href="#UseDynamicArrayProgram">Program 18.4</a> illustrates how to modify and extend
<a href="#ReadIntoFixedArrayProgram">Program 18.1</a> to use this new class. Since the
array grows automatically, there is no need for the original program to
check for out-of-bounds exceptions. Of course, the array expansion only
works if the reference occurs exactly at the index corresponding to one
beyond the end of the array. Other out-of-bound references generate an
exception.</p>
</div>
<div id="UseDynamicArrayProgram" class="listingblock">
<div class="title">Program 18.4 Uses the <code>DynamicArray</code> class to store input read from a file.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UseDynamicArray</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">DynamicArray</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DynamicArray</span><span class="o">();</span>

        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
            <span class="n">names</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
            <span class="n">n</span><span class="o">++;</span>
        <span class="o">}</span>

        <span class="n">names</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">names</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since <code>names</code> is no longer an array, but rather an object of class
<code>DynamicArray</code>, we can no longer use braces (<code>[]</code>) to access elements,
but must use accessor methods <code>set()</code> and <code>get()</code>. Also, <code>Arrays.sort()</code>
cannot sort this object, so we need to provide a <code>sort()</code> method in the
class itself to sort the private array on demand.</p>
</div>
<div class="paragraph">
<p>This implementation, like most implementations of dynamic arrays, has
potentially serious performance penalties. If the initial array is too
small, compared to the final size, then it will have been doubled and
the elements copied multiple times, resulting in slower execution. After
a resize, the array is only half full, resulting in wasted space. Even
on average, the array will only be three-quarters full.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#threeQuarterFullArrayExercise">Exercise 18.5</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_linked_lists_2">18.3.2. Linked lists</h4>
<div class="paragraph">
<p>As we’ve seen, while dynamic arrays can grow to accommodate a large
number of items, the performance penalties of repeated copying and the
space wasted by unoccupied array elements can negatively affect program
behavior. In this section, we introduce the <em>linked list</em>, an
alternative data structure that can efficiently grow to accommodate a
large number of objects. As we shall see, this efficient growth comes at
the expense of limitations on how the structure can be accessed.</p>
</div>
<div class="paragraph">
<p>Consider again the problem of reading an arbitrary number of names from
an input file and storing them. Since we don’t know in advance how many
names there are, it may not be efficient to pre-allocate or dynamically
grow an array to store them. Imagine, instead, that we could write each
name on a small index card, and then link the index cards together to
keep track of them, much like the cars of a railroad train are linked by
the coupling from one to the next.</p>
</div>
<div class="sect4">
<h5 id="_constructing_a_linked_list">Constructing a linked list</h5>
<div class="paragraph">
<p>In Java, a linked list is usually implemented as a class that provides
methods to interact with a sequence of objects. The objects in the list
are implemented as a private static nested class. A private static
nested class behaves like a normal class but can only be created and
accessed by the class surrounding it. In this way, the internal
representation of the list is hidden and protected from outside
modification. The nested class has two fields, one containing the data
to be stored and the other containing a link or reference to the next
object, or <em>node</em>, in the list. Since they are only accessed by the
outer class, it is reasonable to make these fields public. If you need a
refresher on static nested classes, refer to <a href="chap8.html#_advanced_nested_classes">Section 9.5</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedList</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

	<span class="c1">//methods for interacting with the list</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the type <code>next</code> is the same as the class it’s inside of! This
apparent circular reference works because the variable only <strong>references</strong>
an object, but the object is not actually contained within the variable.
In fact, the value of the link may be <code>null</code>, indicating that there are
no additional nodes in the list.</p>
</div>
<div class="paragraph">
<p>In the railroad metaphor, the node is a train car (with its freight as
the value), and the link to the next node is the coupling to the next
car.</p>
</div>
<div class="paragraph">
<p>The definition of <code>LinkedList</code> given above is a good start, but it needs
a <code>head</code> reference that keeps track of the first node in the list.
Initially, this value is <code>null</code>. We also need an <code>add()</code> method so that
we can add nodes to the list. Without checking through the entire list,
it is useful to know how many nodes are in it. We can create a <code>size</code>
field that we increment whenever we add a node, as well as an accessor
to read its value. Finally, we can create a <code>fillArray()</code> method that
fills an array with the values in the list.</p>
</div>
<div id="LinkedListProgram" class="listingblock">
<div class="title">Program 18.5 Basic implementation of a linked list class to hold <code>String</code> objects.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedList</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="n">size</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">size</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fillArray</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">temp</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">position</span><span class="o">++]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#UseLinkedListProgram">Program 18.6</a> is a re-implementation of the
name-reading program using class <code>LinkedList</code>. Note that no array needs
to be pre-allocated. Instead, we capture all the lines of input into a
linked list called <code>list</code>.</p>
</div>
<div id="UseLinkedListProgram" class="listingblock">
<div class="title">Program 18.6 Uses the <code>LinkedList</code> class to store input read from a file.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UseLinkedList</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="n">LinkedList</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">();</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">())</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">());</span>

        <span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">list</span><span class="o">.</span><span class="na">getSize</span><span class="o">()];</span>
        <span class="n">list</span><span class="o">.</span><span class="na">fillArray</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>

        <span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">names</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">names</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Each time we read a new line from the file, the <code>LinkedList</code> class
internally creates a new <code>Node</code> with the input line as its <code>value</code>. It
also sets its <code>next</code> reference to the <strong>current</strong> <code>head</code> so that the rest
of the list (which could be empty if <code>head</code> is <code>null</code>) comes after the
new <code>Node</code>. We then update the <code>head</code> field to reference the new <code>Node</code>.
Thus, each new line read from the file is stored at the <strong>beginning</strong> of
the linked list. The last node in the list, which contains the first
<code>String</code> read in, has a <code>next</code> value of <code>null</code>. <a href="#figure-linked_list_classes">Figure 18.4</a> shows a visualization of the contents of this
implementation of a linked list. An “X” is used in place of an arrow
that points to <code>null</code>.</p>
</div>
<div id="figure-linked_list_classes" class="imageblock">
<div class="content">
<img src="chapters/18-dynamic-data-structures/images/linkedlistclasses.svg" alt="linkedlistclasses" width="100%">
</div>
<div class="title">Figure 18.4 Visualization of linked list implementation with classes.</div>
</div>
<div class="paragraph">
<p>Since we also increment the <code>size</code> field inside of <code>LinkedList</code> on each
add, we know how many <code>String</code> objects it contains. Thus, the
<code>toString()</code> method knows how large of an array to allocate. It then
visits every node in the linked list, storing its <code>value</code> into the
array. In <code>UseLinkedList</code>, we sort the returned array as before and then
print it.</p>
</div>
</div>
<div class="sect4">
<h5 id="_appending_to_the_end_of_a_linked_list">Appending to the end of a linked list</h5>
<div class="paragraph">
<p>The <code>LinkedList</code> class maintains a field named <code>head</code> that references
the first node in the linked list. As we saw, that element was actually
the <strong>last</strong> or <strong>most recent</strong> <code>String</code> read from input. This <code>head</code>
element was followed by the next most recent <code>String</code>, followed by the
next most recent <code>String</code>, and so on. The last node contained the first
<code>String</code> read from input and had a <code>null</code> <code>next</code> field.</p>
</div>
<div class="paragraph">
<p>If we want the linked list to be ordered in the natural way, with <code>head</code>
pointing to the first element read from the file and the last element on
the list (the one with <code>next</code> pointing to <code>null</code>) containing the
<code>String</code> most recently read, we can maintain a second field that
references the <em>tail</em> of the list.</p>
</div>
<div class="paragraph">
<p><a href="#LinkedListWithTailProgram">Program 18.7</a> adds a <em>tail pointer</em> called
<code>tail</code> to the <code>LinkedList</code> class. Note that we have changed the <code>add()</code>
method to the <code>addFirst()</code> method, and we have also added an <code>addLast()</code>
method to make it easy to append elements to the end of a linked list.
Note that the <code>addFirst()</code> method has been updated to change the <code>tail</code>
pointer, but only if the list is empty (<code>head</code> is <code>null</code>). After all,
adding to the front of a list only changes <code>tail</code> if the front is <strong>also</strong>
the back. In the <code>addLast()</code> method, adding a value to an empty list
also sets both the <code>head</code> and <code>tail</code> to point at a node containing that
value. Once the list has a node in it, subsequent calls to <code>addLast()</code>
creates a new <code>Node</code>, points the <code>next</code> field of the old <code>tail</code> at it,
and changes the <code>tail</code> field so that it also points at it.</p>
</div>
<div id="LinkedListWithTailProgram" class="listingblock">
<div class="title">Program 18.7 We can append to the end of a linked list by using an additional variable, <code>tail</code>, to reference the last element (tail) of the list.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedListWithTail</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span> <span class="n">tail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFirst</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">tail</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">size</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addLast</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">tail</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="k">else</span>
            <span class="n">tail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="n">size</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getSize</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">size</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fillArray</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">temp</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">position</span><span class="o">++]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_inserting_into_a_linked_list">Inserting into a linked list</h5>
<div class="paragraph">
<p>In the running example for this chapter, we are interested in printing a
sorted list of <code>String</code> objects read from input. Thus far we have
captured the lines into a linked list of elements, dumped these elements
into an array of the right size, and then sorted the array. An
alternative solution is to insert the elements into the linked list at
the right point in the first place.</p>
</div>
<div class="paragraph">
<p><a href="#SortedLinkedListProgram">Program 18.8</a> is a version of a linked list that
inserts elements into the linked list in sorted order. The only
significant difference between it and the previous implementations of a
linked list is its <code>add()</code> method. This method walks down the linked
list, starting at <code>head</code>, until it either walks off the end of the list
or finds an element before which the new <code>String</code> should go. There are
special cases that must be handled to make this process work correctly.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Empty list</dt>
<dd>
<p>The first time an item is inserted into a linked list, the <code>head</code> and
<code>tail</code> fields must be set to reference this new node. The <code>next</code> field
of the new node is <code>null</code>.</p>
</dd>
<dt class="hdlist1">Insert at beginning</dt>
<dd>
<p>If a node is inserted at the beginning of the list, the <code>head</code> must be
updated to point to this new node. The <code>next</code> field of the new node is
set to the old value of <code>head</code>.</p>
</dd>
<dt class="hdlist1">Insert in middle</dt>
<dd>
<p>To insert a node in the middle of a linked list, it is typically
necessary to maintain two variables to reference the <code>current</code> and
<code>previous</code> nodes while walking down the list. Once the proper
insertion point is found (between the <code>previous</code> and <code>current</code> nodes),
the <code>next</code> field for the <code>previous</code> node is adjusted to reference the
new node, and <code>next</code> field for the new node is set to <code>current</code>.</p>
</dd>
<dt class="hdlist1">Insert at end</dt>
<dd>
<p>If the insertion is taking place at the end of the list, <code>current</code> is
<code>null</code>, and the new node has a <code>next</code> field of <code>null</code>. However, the
<code>tail</code> field must be updated to reference the new node.</p>
</dd>
</dl>
</div>
<div id="SortedLinkedListProgram" class="listingblock">
<div class="title">Program 18.8 Linked list class in which calling the <code>add()</code> method inserts each value in sorted order.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SortedLinkedList</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span> <span class="n">tail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span> <span class="n">String</span> <span class="n">value</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span><span class="o">(</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span>
            <span class="c1">//empty list</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="k">else</span> <span class="nf">if</span><span class="o">(</span> <span class="n">value</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span> <span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
            <span class="c1">//insert at beginning</span>
            <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="c1">//insert at middle or end</span>
            <span class="n">Node</span> <span class="n">previous</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
            <span class="n">Node</span> <span class="n">current</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>

            <span class="k">while</span><span class="o">(</span> <span class="n">current</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span>
                <span class="n">value</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span> <span class="n">current</span><span class="o">.</span><span class="na">value</span> <span class="o">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
                <span class="n">previous</span> <span class="o">=</span> <span class="n">current</span><span class="o">;</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="n">previous</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
            <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">current</span><span class="o">;</span>

            <span class="k">if</span><span class="o">(</span> <span class="n">current</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="c1">//insert at end of list</span>
                <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">size</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">size</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fillArray</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">temp</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">position</span><span class="o">++]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_abstract_data_types_adt">18.4. Syntax: Abstract data types (ADT)</h3>
<div class="paragraph">
<p>We’ve seen two examples so far of dynamic data structures: dynamic
arrays and linked lists. A great deal of complexity can go on inside
these data structures, but code that uses these data structures does not
need to be aware of the details of the internal implementation. Ideally,
user programs could use any data structure that provided the needed set
of operations.</p>
</div>
<div class="paragraph">
<p>Our dynamic array and linked list classes were simple examples of
abstract data types (ADT). We continue to design data structures that
hide the details of their implementation inside a class. The user of
each class is aware of the operations (public methods) that can be
performed on objects of the class, but not on the techniques used to
implement those operations. Defining an ADT without regard to an
implementation keeps users of the ADT from becoming dependent on details
of any particular implementation. It gives maximum freedom to the
programmer to choose (and change) the implementation as appropriate for
the overall system design.</p>
</div>
<div class="paragraph">
<p>We generalize a data structure by observing which operations are applied
to it. Then, we create an abstraction that formalizes these
observations. The idea is to cleanly separate the use and behavior of
the data structure from the way in which it is implemented.</p>
</div>
<div class="paragraph">
<p>Interfaces are the obvious tool for defining the behavior of a class in
Java without specifying its implementation. When defining an ADT in
Java, the set of operations becomes the set of methods given by the
interface. Then, any class that implements the ADT must implement the
interface that defines that ADT.</p>
</div>
<div class="paragraph">
<p>In subsequent sections we look at two fundamental abstract data types,
<em>stacks</em> and <em>queues</em>, and sample classes that implement them.</p>
</div>
<div class="sect3">
<h4 id="_stacks">18.4.1. Stacks</h4>
<div class="paragraph">
<p>We have already used stacks to solve problems in
<a href="chap8.html#ch09-classes">Chapter 9</a>. Recall that a stack data structure behaves
like a stack of books on your desk. When you place a book on the stack
it covers the books that are already there. When you take a book off the
stack, you remove the book most recently placed there, exposing the one
beneath it.</p>
</div>
<div class="paragraph">
<p>You can find a simple implementation of a stack in the solution to the
infix conversion problem in <a href="#_solution_infix_conversion">Section 18.6</a>, but
we now examine the stack more deeply as an archetypal ADT. A stack’s
restricted set of operations (pushing and popping) is adequate for many
tasks and can be implemented in a number of different ways, some more
efficient than others.</p>
</div>
<div class="paragraph">
<p>The acronym FILO (first in, last out) is sometimes used to describe a
stack. The last item that has been pushed onto the stack is the first
item to be popped off the stack. In the next section, we’ll study the
<em>queue</em>, which is a FIFO (first in, first out) data structure.</p>
</div>
</div>
<div class="sect3">
<h4 id="_abstract_data_type_operations_on_a_stack">18.4.2. Abstract Data Type: Operations on a stack</h4>
<div class="paragraph">
<p>There are two essential operations on a stack abstract data type
(corresponding to placing a book on the pile and removing it): <code>push()</code>
and <code>pop()</code>. We also define two additional operations, <code>top()</code> and
<code>isEmpty()</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>push(x)</code>:</strong> Push value <code>x</code> onto the stack.</p>
</li>
<li>
<p><strong><code>pop()</code>:</strong> Pop the value on the top of the stack, and return its
value.</p>
</li>
<li>
<p><strong><code>top()</code>:</strong> Return the value on the top of the stack, but do not pop it
off.</p>
</li>
<li>
<p><strong><code>isEmpty()</code>:</strong> Return <code>true</code> if the stack is empty, <code>false</code> otherwise.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because a stack is an abstract data type, we are not specifically
concerned with <strong>how</strong> these operations are implemented, merely that they
are. Thus, we can specify an interface called <code>Stack</code> that requires
these four methods.</p>
</div>
<div id="StackProgram" class="listingblock">
<div class="title">Program 18.9 Interface specifying the stack ADT.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Stack</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">);</span>
    <span class="n">String</span> <span class="nf">pop</span><span class="o">();</span>
    <span class="n">String</span> <span class="nf">top</span><span class="o">();</span>
    <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_linked_list_implementation">Linked list implementation</h5>
<div class="paragraph">
<p>All the operations defined by the stack ADT (and interface) are
implemented as methods in the class <code>LinkedListStack</code>, shown in
<a href="#LinkedListStackProgram">Program 18.10</a>.</p>
</div>
<div id="LinkedListStackProgram" class="listingblock">
<div class="title">Program 18.10 Class to implement a stack ADT using a linked list.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedListStack</span> <span class="kd">implements</span> <span class="n">Stack</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't pop empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">top</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;No top on an empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>head</code> field is used to maintain a reference to the linked list that
defines the stack. It is initialized to <code>null</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The method <code>push()</code> must create a new node for the linked list and push
it onto the front of the list. It does so by creating a new <code>Node</code>,
setting its <code>value</code> field to the incoming <code>value</code>, and pointing its
<code>next</code> pointer to the beginning of the list, stored by <code>head</code>. Since
<code>temp</code> is now the new top of the stack, <code>head</code> is made to point at it.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>pop()</code> method needs to return the <code>value</code> of the <code>head</code> node and
remove that node from the linked list. It does this by replacing the
<code>head</code> node with the node pointed at by the <code>next</code> link in <code>head</code>. The
<code>pop()</code> method from the simpler stack used in the solution to the nested
expressions problem in <a href="chap8.html#_solution_nested_expressions">Section 9.6</a> merely
removed the top and did not return the value. Most real-world stack
implementations of <code>pop()</code> <strong>do</strong> return this value, giving programmers
more flexibility.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that both <code>pop()</code> and <code>top()</code> print an error message if the stack
is empty. Other more elaborate error handling is possible by throwing an exception.</p>
</div>
</div>
<div class="sect4">
<h5 id="_dynamic_array_implementation">Dynamic array implementation</h5>
<div class="paragraph">
<p>Like the dynamic array example of <a href="#UseDynamicArrayProgram">Program 18.4</a>,
<a href="#DynamicArrayStackProgram">Program 18.11</a> implements a stack of <code>String</code>
values using a dynamic array data structure.</p>
</div>
<div id="DynamicArrayStackProgram" class="listingblock">
<div class="title">Program 18.11 Illustrates a stack ADT partially implemented using a dynamic array.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DynamicArrayStack</span> <span class="kd">implements</span> <span class="n">Stack</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">String</span> <span class="n">string</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">size</span> <span class="o">==</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span> <span class="o">)</span>
            <span class="n">doubleArray</span><span class="o">();</span>
        <span class="n">strings</span><span class="o">[</span><span class="n">size</span><span class="o">++]</span> <span class="o">=</span> <span class="n">string</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't pop empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">strings</span><span class="o">[--</span><span class="n">size</span><span class="o">];</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">doubleArray</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOfRange</span><span class="o">(</span><span class="n">strings</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">*</span><span class="mi">2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This stack implementation using a dynamic array omits the <code>top()</code> and
<code>isEmpty()</code> methods (causing a compiler error in
<a href="#DynamicArrayStackProgram">Program 18.11</a> until the <code>Stack</code> interface is
properly implemented).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#stackMethodsExercise">Exercise 18.7</a></p>
</div>
</div>
</div>
<div id="postfixComputationExample" class="exampleblock">
<div class="title">Example 18.1 Postfix computation</div>
<div class="content">
<div class="paragraph">
<p>At the beginning of the chapter, we introduced the problem of converting
an expression from infix to postfix notation. In
<a href="#_solution_infix_conversion">Section 18.6</a>, we give the solution to this
problem, but without a program that can evaluate a postfix expression,
the conversion tool is not very useful.</p>
</div>
<div class="paragraph">
<p>Here we give a simple postfix evaluator. Recall the algorithm: Scan the
input expression from left to right, if you see a number, put it on the
stack. If you see an operator, pop the last two operands off the stack
and use the operator on them. Then, push the result back on the stack.
When you run out of input, the value at the top of the stack is your
answer.</p>
</div>
<div class="paragraph">
<p>Like the infix to postfix converter, we restrict our input to positive
integers of a single digit. To make this program simpler, we introduce
two new classes that are also useful in our infix to postfix converter.
The first is <code>Term</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Term</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">value</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Term</span><span class="o">(</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This class allows us to hold an <code>int</code> value. Although its structure is
simple, we update the definition of <code>Term</code> later in the solution to the
infix to postfix conversion problem. By doing so, we can keep exactly
the same definition for <code>TermStack</code> given next.</p>
</div>
<div id="TermStackProgram" class="listingblock">
<div class="title">Program 18.12 Class to manage a stack of <code>Term</code> objects.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TermStack</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">Term</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span> <span class="n">Term</span> <span class="n">value</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Term</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Term</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't pop empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Term</span> <span class="nf">top</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Term</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;No top on an empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This class gives a linked list implementation of a stack. In fact, it is
virtually identical to <a href="#LinkedListStackProgram">Program 18.10</a> with the
substitution of <code>Term</code> for <code>String</code>.</p>
</div>
<div id="PostfixCalculatorProgram" class="listingblock">
<div class="title">Program 18.13 Evaluates a postfix expression.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostfixCalculator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span> <span class="n">System</span><span class="o">.</span><span class="na">in</span> <span class="o">);</span>
        <span class="n">String</span> <span class="n">expression</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
        <span class="n">TermStack</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TermStack</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">expression</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++</span> <span class="o">)</span> <span class="o">{</span>
            <span class="kt">char</span> <span class="n">term</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span>  <span class="n">term</span> <span class="o">&gt;=</span> <span class="sc">'0'</span><span class="o">&amp;&amp;</span> <span class="n">term</span> <span class="o">&lt;=</span> <span class="sc">'9'</span> <span class="o">)</span>
                <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="o">(</span><span class="kt">int</span><span class="o">)(</span><span class="n">term</span> <span class="o">-</span> <span class="sc">'0'</span><span class="o">))</span> <span class="o">);</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">().</span><span class="na">getValue</span><span class="o">();</span>
                <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">().</span><span class="na">getValue</span><span class="o">();</span>
                <span class="k">switch</span><span class="o">(</span> <span class="n">term</span> <span class="o">)</span> <span class="o">{</span>
                    <span class="k">case</span> <span class="sc">'+'</span><span class="o">:</span> <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">)</span> <span class="o">);</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="sc">'-'</span><span class="o">:</span> <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">)</span> <span class="o">);</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="sc">'*'</span><span class="o">:</span> <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">)</span> <span class="o">);</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="sc">'/'</span><span class="o">:</span> <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="o">)</span> <span class="o">);</span>
                        <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;The answer is: &quot;</span> <span class="o">+</span>
                <span class="n">stack</span><span class="o">.</span><span class="na">top</span><span class="o">().</span><span class="na">getValue</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With our utility classes in place, the code for the postfix evaluator is
short. Our <code>main()</code> method reads in the expression from the user and
creates a <code>TermStack</code> called <code>stack</code>. Then, it iterates through the
expression with a <code>for</code> loop. For each number we find, we supply it as
an argument to the constructor of a new <code>Term</code> object, which we push
onto <code>stack</code>.</p>
</div>
<div class="paragraph">
<p>For each operator, we pop two items off <code>stack</code> and apply the operator
to them. We create a new <code>Term</code> from the result and push this value onto
<code>stack</code>. Finally, after all input is exhausted, we print the value on
the top of <code>stack</code>. To test it properly, you have to supply expressions
in postfix form. Also, remember that these operations are all integer
operations without fractional parts. Be careful to avoid division by
zero!.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_queues">18.4.3. Queues</h4>
<div class="paragraph">
<p>A <em>queue</em> data structure is similar to a stack data structure, except
that when getting an item from a queue, the item that has been in the
queue longest is the one retrieved. A queue data structure models an
ordinary queue or line of people. The first person into the queue or
line at a bank, for example, is the first one to receive service. Late
comers are served in the order in which they arrive.</p>
</div>
<div class="paragraph">
<p>A queue is sometimes called a FIFO (first in, first out) data structure
due to this property. To distinguish the operations on a queue from
those on a stack, we use the terms enqueue and dequeue instead of push
and pop.</p>
</div>
</div>
<div class="sect3">
<h4 id="_abstract_data_type_operations_on_a_queue">18.4.4. Abstract Data Type: Operations on a queue</h4>
<div class="paragraph">
<p>Four typical operations on a queue data structure are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>enqueue(x)</code>:</strong> Put value <code>x</code> onto the end of the queue.</p>
</li>
<li>
<p><strong><code>dequeue()</code>:</strong> Remove and return the value at the front of the queue,
that is, the value that has been on the queue the longest.</p>
</li>
<li>
<p><strong><code>front()</code>:</strong> Return (but do not remove) the value at the front of the
queue.</p>
</li>
<li>
<p><strong><code>isEmpty()</code>:</strong> Return <code>true</code> if the queue is empty, <code>false</code> otherwise.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As with stacks, we can specify an interface called <code>Queue</code> that requires
these four methods.</p>
</div>
<div id="QueueProgram" class="listingblock">
<div class="title">Program 18.14 Interface specifying the queue ADT.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Queue</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">);</span>
    <span class="n">String</span> <span class="nf">dequeue</span><span class="o">();</span>
    <span class="n">String</span> <span class="nf">front</span><span class="o">();</span>
    <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_linked_list_implementation_2">Linked list implementation</h5>
<div class="paragraph">
<p><a href="#LinkedListQueueProgram">Program 18.15</a> shows an implementation of the queue
ADT operations using a linked list. Because we need to keep track of
nodes at both ends of the linked list, we maintain <code>head</code> and <code>tail</code>
variables to reference these nodes. The <code>enqueue()</code> and <code>dequeue()</code>
methods manipulate these variables to manage the queue as values are put
onto it and removed from it.</p>
</div>
<div id="LinkedListQueueProgram" class="listingblock">
<div class="title">Program 18.15 Illustrates a queue ADT implemented using a linked list.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedListQueue</span> <span class="kd">implements</span> <span class="n">Queue</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span> <span class="n">tail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span><span class="o">(</span> <span class="n">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">tail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">dequeue</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't dequeue an empty queue!&quot;</span><span class="o">);</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="k">if</span><span class="o">(</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span>
                <span class="n">tail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">front</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;No front on an empty queue!&quot;</span><span class="o">);</span>
        <span class="k">else</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the implemention of the <code>LinkedListQueue</code> class is very
similar to the implementation of the <code>LinkedListWithTail</code> class. The
<code>enqueue()</code> method in the former is almost identical to the <code>addLast()</code>
method in the latter.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_generic_data_structures">18.5. Advanced: Generic data structures</h3>
<div class="paragraph">
<p>Most of the dynamic data structures we have seen in this chapter store
values of type <code>String</code>. We explore dynamic arrays of <code>String</code> values,
linked lists of <code>String</code> objects, queues of <code>String</code> objects, and stacks
of <code>String</code> objects. In <a href="#postfixComputationExample">Example 18.1</a>, we
create the stack class <code>TermStack</code> to hold <code>Term</code> objects, but
<code>TermStack</code> is identical to the existing <code>LinkedListStack</code> class with
the substitution of <code>Term</code> for <code>String</code>.</p>
</div>
<div class="paragraph">
<p>What if you wanted to store values of some other type in these data
structures? What if you wanted a stack of <code>int</code> values or a queue of
<code>Thread</code> objects? You might think that you need to create a distinct but
similar implementation of each ADT for each type, as we do in
<a href="#postfixComputationExample">Example 18.1</a>.</p>
</div>
<div class="paragraph">
<p>One possible solution is to take advantage of the fact that a variable
of type <code>Object</code> can hold a reference to a value of any reference type
(since all classes are subtypes of <code>Object</code>). If we create data
structures using <code>Object</code> as the underlying type, we can store values of
any type in the data structure. For example,
<a href="#ObjectStackProgram">Program 18.16</a> is an implementation of a stack ADT with
an underlying data type of <code>Object</code>.</p>
</div>
<div id="ObjectStackProgram" class="listingblock">
<div class="title">Program 18.16 Class that implements a stack of <code>Object</code> references.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ObjectStack</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't pop empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">top</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't get top of empty stack!&quot;</span><span class="o">);</span>
        <span class="k">else</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a stack of <code>Object</code> references is an example of a
<em>heterogeneous data structure</em>. It is possible to put objects of
different types onto the same stack. While there are situations in which
this technique is useful, in most cases a <em>homogeneous data structure</em>
(where all values are of the same type) is all that is needed.
Homogeneous data structures allow type checking to occur at compile
time, thus helping to avoid run-time errors.</p>
</div>
<div class="paragraph">
<p>Using a stack of <code>Object</code> references is generally more cumbersome, since
you must cast values returned from <code>pop()</code> or <code>top()</code> to the appropriate
data type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="n">ObjectStack</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectStack</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Without the cast to <code>(String)</code>, the compiler gives an error:
<code>Type mismatch: cannot convert from Object to String</code>.</p>
</div>
<div class="paragraph">
<p>Casting the returning value from a heterogeneous data structure
essentially forces type checking to move from compile-time to run-time.
Instead of having the Java compiler verify the type correctness of
operations, we force the Java virtual machine to do the check.</p>
</div>
<div class="sect3">
<h4 id="_generics_in_java">18.5.1. Generics in Java</h4>
<div class="paragraph">
<p>Java provides a general facility to create classes that implement the
same basic ADT but with a different underlying data type. This mechanism
preserves the advantages of compile-time type checking and eliminates
the need for run-time casting. A <em>generic class</em> is a class that gives a
template for creating classes in which a placeholder for the underlying
data type can be filled in when a specific instance of that class is
created. In the case of <a href="#postfixComputationExample">Example 18.1</a>, we need
a stack that can hold <code>Term</code> objects instead of <code>String</code> objects, and a
generic class allows us to create a stack of any reference type.</p>
</div>
<div class="paragraph">
<p>The generics facility in Java only supports underlying data types that
are reference types (such as <code>String</code> and user-defined types), not
primitive types (such as <code>int</code> or <code>boolean</code>). However, we can use
wrapper classes to hold primitives types. Thus, a generic stack of <code>int</code>
values needs to be implemented as a stack of <code>Integer</code> objects.
Fortunately, Java automatically converts between <code>int</code> and <code>Integer</code> in
most cases.</p>
</div>
<div class="paragraph">
<p>Defining a simple generic class in Java is done by appending a <em>type
parameter</em> within angle brackets (<code>&lt;&gt;</code>) to the end of the class name
being defined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericClass</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="n">T</span> <span class="nf">transform</span> <span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
    <span class="o">...</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This code defines a new generic class (think class template)
<code>GenericClass</code> with underlying type <code>T</code>. It includes a method
<code>transform()</code> that takes a value of type <code>T</code> and transforms it (in some
unspecified way) to another value of type <code>T</code>.</p>
</div>
<div class="paragraph">
<p>To use a generic class properly, you must create instances of it
specifying the underlying type. In actual fact, the compiler fills in
the appropriate type at compile time. The compiler must make sure that
all the operations are valid with the supplied type substituted for the
type parameter (<code>T</code> in this example).</p>
</div>
<div class="paragraph">
<p>For example, to create and use an instance of <code>GenericClass</code> with
underlying type <code>String</code>, you would type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="n">GenericClass</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">genericString</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GenericClass</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">generic</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this use of the <code>GenericClass</code> class is defined for underlying
type <code>String</code>, no casting is necessary to assign the result of the
<code>transform()</code> method to the <code>String</code> variable <code>s</code>.</p>
</div>
<div class="paragraph">
<p>To create and use an instance of <code>GenericClass</code> with underlying type
<code>Integer</code>, you would type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="n">GenericClass</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">genericInteger</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GenericClass</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">generic</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="mi">27</span><span class="o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The same definition of <code>GenericClass</code> is used in both instances with
different underlying data types <strong>and</strong> the compiler is able to verify at
compile time that the uses are type safe.</p>
</div>
<div class="paragraph">
<p>If you omit the underlying type when declaring a generic variable or
creating an instance of a generic type, the compiler uses <code>Object</code> as
the underlying type. This use, called a <em>raw type</em>, is essentially like
not using generics at all. There is no compile-time type checking, and
references must be cast as needed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="n">GenericClass</span> <span class="n">genericRaw</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GenericClass</span><span class="o">();</span> <span class="c1">// raw type</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span> <span class="n">genericRaw</span><span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="mi">27</span><span class="o">);</span> <span class="c1">// cast needed</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next two examples illustrate defining generic classes in Java.</p>
</div>
<div class="exampleblock">
<div class="title">Example 18.2 Defining a generic linked list</div>
<div class="content">
<div class="paragraph">
<p><a href="#GenericLinkedListProgram">Program 18.17</a> defines a generic version of the
<code>LinkedList</code> class shown earlier. Note that it is necessary to include
the type parameter <code>T</code> on the outer class as well as the nested class
<code>Node</code>.</p>
</div>
<div id="GenericLinkedListProgram" class="listingblock">
<div class="title">Program 18.17 Class that implements a generic linked list.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericLinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">T</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="n">size</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">size</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fillArray</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">head</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">temp</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">position</span><span class="o">++]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using generics can be very easy, but there are some oddities. In
particular, there are problems instantiating arrays with generic types.
The <code>fillArray()</code> method works because it never creates the array, only
fills it.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_a_generic_class">18.5.2. Using a Generic Class</h4>
<div class="paragraph">
<p>Creating an instance of a generic class is similar to creating an
instance of a regular class, except that (to avoid warnings) you must
specify the missing type (or types) used to parameterize the generic
class. For example, if you want to create an instance of the
<code>GenericClass&lt;T&gt;</code> class, you must specify the type <code>T</code>, for example
<code>new GenericClass&lt;String&gt;()</code>.</p>
</div>
<div class="paragraph">
<p><a href="#UseGenericLinkedListProgram">Program 18.18</a> uses the generic class
<code>GenericLinkedList</code> parameterized by <code>String</code> to re-implement
<a href="#UseLinkedListProgram">Program 18.6</a>.</p>
</div>
<div id="UseGenericLinkedListProgram" class="listingblock">
<div class="title">Program 18.18 Uses the generic class <code>GenericLinkedList</code> to create and use a linked list of Strings.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UseGenericLinkedList</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="n">GenericLinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
            <span class="k">new</span> <span class="n">GenericLinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

        <span class="k">while</span><span class="o">(</span> <span class="n">in</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()</span> <span class="o">);</span>

        <span class="n">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">list</span><span class="o">.</span><span class="na">getSize</span><span class="o">()];</span>
        <span class="n">list</span><span class="o">.</span><span class="na">fillArray</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>

        <span class="n">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">names</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">names</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_java_libraries">18.5.3. Using Java Libraries</h4>
<div class="paragraph">
<p>Many of the Java library classes use generics to make them more general
purpose. The <code>java.util</code> package includes many classes to implement
stacks, queues, dynamic arrays, sets, and other useful data structures.
These classes are parameterized so that they can be created with
different underlying types. We illustrate three examples here: <code>Vector</code>,
<code>ArrayList</code>, and <code>HashMap</code>. Note that there is also a <code>LinkedList</code>
class, which is a great deal more powerful than the <code>LinkedList</code> class
defined in this chapter. Any class that implements the <code>Iterable</code>
interface can be used in the enhanced <code>for</code> loops described in
<a href="chap5.html#_enhanced_for_loops">Section 6.9.1</a>. The <code>ArrayDeque</code>, <code>ArrayList</code>,
<code>HashSet</code>, <code>TreeSet</code>, and <code>Vector</code>, classes all implement <code>Iterable</code>. In
our examples, a <code>Vector</code> object and a <code>Set</code> (returned by the
<code>entrySet()</code> method of a <code>HashMap</code>) are used as targest of enhanced <code>for</code>
loops.</p>
</div>
<div class="exampleblock">
<div class="title">Example 18.3 Vectors</div>
<div class="content">
<div class="paragraph">
<p>A <code>Vector</code> (<code>java.util.Vector</code>) implements an array of objects that can
grow at run time. The array is automatically extended whenever an
attempt is made to store an item exactly one location beyond the last
element. Unlike a linked list, <code>Vector</code> elements can be efficiently
accessed in any order (by specifying the index, just like an ordinary
array). Elements can be inserted into the middle of the <code>Vector</code>,
causing following elements to be pushed back to later indexes. Arbitrary
elements can also be deleted from the <code>Vector</code> using the <code>remove()</code>
method.</p>
</div>
<div class="paragraph">
<p><a href="#VectorExampleProgram">Program 18.19</a> illustrates a use of the <code>Vector</code>
class. The program creates an empty <code>Vector</code> and generates random
integers between 1 and 10, appending them to the end of the vector,
until their sum is at least 100. Then, it prints the integers and their
sum (including how many were generated).</p>
</div>
<div id="VectorExampleProgram" class="listingblock">
<div class="title">Program 18.19 Illustrates the use of the Vector class.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Vector</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">VectorExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>

        <span class="n">Vector</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">vector</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>

        <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">sum</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="n">vector</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>  <span class="c1">// append n to end of vector</span>
            <span class="n">sum</span> <span class="o">+=</span> <span class="n">n</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">for</span><span class="o">(</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">:</span> <span class="n">vector</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%3d\n&quot;</span><span class="o">,</span> <span class="n">n</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;---&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;%3d (%d values)\n&quot;</span><span class="o">,</span> <span class="n">sum</span><span class="o">,</span> <span class="n">vector</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Output from a typical run of <a href="#VectorExampleProgram">Program 18.19</a> is shown
below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  9
  9
  8
  7
  7
  4
  7
  6
  8
  7
  9
  4
  9
 10
---
104 (14 values)</pre>
</div>
</div>
</div>
</div>
<div id="mapsExample" class="exampleblock">
<div class="title">Example 18.4 Maps</div>
<div class="content">
<div class="paragraph">
<p>The <code>HashMap</code>(<code>java.util.HashMap</code>) is a very useful, general-purpose
data structure that maintains a dictionary of entries. A dictionary
associates unique keys with values. You can think of it as <em>mapping</em> a
<em>key</em> to a <em>value</em>. In the Java <code>HashMap</code> class, keys and values can be
arbitrary Java classes.</p>
</div>
<div class="paragraph">
<p><a href="#HashMapExampleProgram">Program 18.20</a> reads a sequence of lines containing
names and ages (for simplicity, the name is one word and the age is a
simple integer). It stores these (name, age) pairs in a
<code>HashMap&lt;String,Integer&gt;</code> data structure. Once all the input is read
(<code>in.hasNext()</code> returns <code>false</code>), the program prints all the keys
(names), then all the values (ages), and finally it prints the names and
ages of each person in the input file.</p>
</div>
<div id="HashMapExampleProgram" class="listingblock">
<div class="title">Program 18.20 Illustrates using a <code>HashMap</code> dictionary to store a set of names and ages.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HashMapExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span>
            <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>

        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">in</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
            <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">age</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;Keys\n&quot;</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span> <span class="n">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;\t&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Values&quot;</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span> <span class="kt">int</span> <span class="n">age</span> <span class="o">:</span> <span class="n">map</span><span class="o">.</span><span class="na">values</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;\t&quot;</span> <span class="o">+</span> <span class="n">age</span><span class="o">);</span>

        <span class="k">for</span><span class="o">(</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">map</span><span class="o">.</span><span class="na">entrySet</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; -&gt; &quot;</span> <span class="o">+</span>
                              <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Shown below is the output for a simple input file.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Keys
    kathy
    martha
    fred
    henway
    michael
    henry
    john
    margarette
    edward
    tim
    hamcost
Values
    60
    22
    15
    1
    21
    31
    23
    57
    12
    57
    2
kathy -&gt; 60
martha -&gt; 22
fred -&gt; 15
henway -&gt; 1
michael -&gt; 21
henry -&gt; 31
john -&gt; 23
margarette -&gt; 57
edward -&gt; 12
tim -&gt; 57
hamcost -&gt; 2</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_solution_infix_conversion">18.6. Solution: Infix conversion</h3>
<div class="paragraph">
<p>Here we give our solution to the infix conversion problem from the
beginning of the chapter. As in <a href="#postfixComputationExample">Example 18.1</a>,
we use a stack of <code>Term</code> objects to solve the problem. However, we
expand the <code>Term</code> class to hold both operands and operators. We only add
methods and fields to the earlier definition, taking nothing away. In
this way, we should be able to use the <code>Term</code> class for both infix to
postfix conversion and postfix calculation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Term</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">value</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">char</span> <span class="n">operator</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isOperator</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we have augmented the earlier <code>Term</code> class by adding two more
fields, a <code>char</code> called <code>operator</code> to hold an operator and a <code>boolean</code>
called <code>isOperator</code> to keep track of whether or not our <code>Term</code> object
holds an operator or an operand.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="kd">public</span> <span class="nf">Term</span><span class="o">(</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">isOperator</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">Term</span><span class="o">(</span> <span class="kt">char</span> <span class="n">operator</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">operator</span> <span class="o">=</span> <span class="n">operator</span><span class="o">;</span>
        <span class="n">isOperator</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We now have two constructors. The first one takes an <code>int</code> value and
stores it into <code>value</code>, setting <code>isOperator</code> to <code>false</code> to indicate that
the <code>Term</code> object must be an operand. The second constructor takes a
<code>char</code> value and stores it into <code>operator</code>, setting <code>isOperator</code> to
<code>true</code> to indicate that the <code>Term</code> object must be an operator (such as
<code>+</code>, <code>-</code>,<code>*</code>, or <code>/</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">char</span> <span class="nf">getOperator</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">operator</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isOperator</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">isOperator</span><span class="o">;</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These three accessors give back the operand value, the operator
character, and whether or not the object is an operator, respectively.
This solution is not necessarily the most elegant from an OOP
perspective. The code that uses a <code>Term</code> object needs to chose the
<code>getValue()</code> method or the <code>getOperator()</code> method depending on whether
the <code>Term</code> is an operator or not. This design opens up the possibility
that some code will call the wrong accessor method and get a useless
default value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">greaterOrEqual</span><span class="o">(</span><span class="n">Term</span> <span class="n">term</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">isOperator</span><span class="o">()</span> <span class="o">)</span>
            <span class="k">switch</span><span class="o">(</span> <span class="n">operator</span> <span class="o">)</span> <span class="o">{</span>
                <span class="k">case</span> <span class="sc">'*'</span><span class="o">:</span>
                <span class="k">case</span> <span class="sc">'/'</span><span class="o">:</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
                <span class="k">case</span> <span class="sc">'+'</span><span class="o">:</span>
                <span class="k">case</span> <span class="sc">'-'</span><span class="o">:</span>
                <span class="k">return</span> <span class="o">(</span><span class="n">term</span><span class="o">.</span><span class="na">operator</span> <span class="o">!=</span> <span class="sc">'*'</span> <span class="o">&amp;&amp;</span>
                        <span class="n">term</span><span class="o">.</span><span class="na">operator</span> <span class="o">!=</span> <span class="sc">'/'</span><span class="o">);</span>
                <span class="k">default</span><span class="o">:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The most complicated addition to the <code>Term</code> class is the
<code>greaterOrEqual()</code> method, which takes in another <code>Term</code> object. This
method compares the operator of the <code>Term</code> object being called with the
one that is being passed in as a parameter. Because this method is in
the <code>Term</code> class, it can access the <code>private</code> variables of the <code>term</code>
parameter. This method returns <code>true</code> if the operator of the called
object has a greater or equal precedence compared to the operator of the
parameter object. The meat of the method is the <code>switch</code> statement that
establishes the high precedence of <code>*</code> and <code>/</code>, the medium precedence of
<code>+</code> and <code>-</code>, and the low precedence of anything else, namely the left
parenthesis <code>(</code>.</p>
</div>
<div class="paragraph">
<p>With this updated <code>Term</code> class, we can create <code>Term</code> objects that hold
either an operator or an operand and allow the precedence of operators
to be compared. We use exactly the same <code>TermStack</code> class from
<a href="#postfixComputationExample">Example 18.1</a> for our stack. All that remains
is the client code that parses the input.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InfixToPostfix</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span> <span class="n">System</span><span class="o">.</span><span class="na">in</span> <span class="o">);</span>
        <span class="n">String</span> <span class="n">expression</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
        <span class="n">TermStack</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TermStack</span><span class="o">(</span><span class="n">expression</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
        <span class="n">String</span> <span class="n">postfix</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="kt">char</span> <span class="n">term</span><span class="o">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>main()</code> method of this class reads in the input expression and
creates a <code>TermStack</code> called <code>stack</code> with a maximum size of the length
of the expression. We also declare a <code>String</code> called <code>postfix</code> to hold
the output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">        <span class="k">for</span><span class="o">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">expression</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">term</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span> <span class="n">term</span> <span class="o">&gt;=</span> <span class="sc">'0'</span> <span class="o">&amp;&amp;</span> <span class="n">term</span> <span class="o">&lt;=</span> <span class="sc">'9'</span> <span class="o">)</span>
                <span class="n">postfix</span> <span class="o">+=</span> <span class="n">term</span><span class="o">;</span>
            <span class="k">else</span> <span class="nf">if</span><span class="o">(</span> <span class="n">term</span> <span class="o">==</span> <span class="sc">'('</span> <span class="o">)</span>
                    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="n">term</span> <span class="o">));</span>
            <span class="k">else</span> <span class="nf">if</span><span class="o">(</span> <span class="n">term</span> <span class="o">==</span> <span class="sc">')'</span> <span class="o">)</span> <span class="o">{</span>
                <span class="k">while</span><span class="o">(</span> <span class="n">stack</span><span class="o">.</span><span class="na">top</span><span class="o">().</span><span class="na">getOperator</span><span class="o">()</span> <span class="o">!=</span> <span class="sc">'('</span> <span class="o">)</span> <span class="o">{</span>
                    <span class="n">postfix</span> <span class="o">+=</span> <span class="n">stack</span><span class="o">.</span><span class="na">top</span><span class="o">().</span><span class="na">getOperator</span><span class="o">();</span>
                    <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
                <span class="o">}</span>
                <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span> <span class="c1">//pop off the '('</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="nf">if</span><span class="o">(</span> <span class="n">term</span> <span class="o">==</span> <span class="sc">'*'</span> <span class="o">||</span> <span class="n">term</span> <span class="o">==</span> <span class="sc">'/'</span> <span class="o">||</span>
                 <span class="n">term</span> <span class="o">==</span> <span class="sc">'+'</span> <span class="o">||</span> <span class="n">term</span> <span class="o">==</span> <span class="sc">'-'</span> <span class="o">)</span> <span class="o">{</span>
                <span class="n">Term</span> <span class="n">operator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Term</span><span class="o">(</span> <span class="n">term</span> <span class="o">);</span>
                <span class="k">while</span><span class="o">(</span> <span class="n">stack</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
                    <span class="n">stack</span><span class="o">.</span><span class="na">top</span><span class="o">().</span><span class="na">greaterOrEqual</span><span class="o">(</span> <span class="n">operator</span> <span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
                    <span class="n">postfix</span> <span class="o">+=</span> <span class="n">stack</span><span class="o">.</span><span class="na">top</span><span class="o">().</span><span class="na">getOperator</span><span class="o">();</span>
                    <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
                <span class="o">}</span>
                <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span> <span class="n">operator</span> <span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>for</code> loop runs through each <code>char</code> in the input expression and
applies the four rules given in the description of the infix conversion
problem. If a term is an operand, it is added to the output. If a term
is a left parenthesis, it is pushed onto the stack. If a term is a right
parenthesis, all the terms on the stack are popped off and added to the
output until a left parenthesis is reached. If a term is a normal
operator, the top of the stack is repeatedly popped and added to output
as long as it has a precedence greater than or equal to the new
operator. The complexity of doing this precedence comparison is now
tucked away inside of the <code>Term</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">        <span class="k">while</span><span class="o">(</span> <span class="n">stack</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">postfix</span> <span class="o">+=</span> <span class="n">stack</span><span class="o">.</span><span class="na">top</span><span class="o">().</span><span class="na">getOperator</span><span class="o">();</span>
            <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">postfix</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After the input has all been consumed, we pop all the elements off the
stack and add them to the output. Finally, we print the output. The
output to this program could be used as the input to the postfix
evaluator program from <a href="#postfixComputationExample">Example 18.1</a>. A more
complex program that did both the conversion and the calculation might
want to store everything in <code>Term</code> objects instead of outputting a
<code>String</code> and then recreating <code>Term</code> objects.</p>
</div>
</div>
<div class="sect2">
<h3 id="_concurrency_linked_lists_and_thread_safety">18.7. Concurrency: Linked lists and thread safety</h3>
<div class="paragraph">
<p>The implementations of stacks and queues in the previous sections are
<strong>not</strong> thread-safe. If multiple threads use a stack or queue object
simultaneously, the <code>head</code> or <code>tail</code> pointers can become inconsistent or
be updated incorrectly, potentially causing the stack or queue to lose
elements. As you have seen, multiple threads operating on the same data
can produce unexpected results.</p>
</div>
<div class="paragraph">
<p><a href="#UseLinkedListQueueProgram">Program 18.21</a> is a simple multi-threaded
program to test (and break!) the thread safety of the queue
implementation in <a href="#LinkedListQueueProgram">Program 18.15</a>.</p>
</div>
<div id="UseLinkedListQueueProgram" class="listingblock">
<div class="title">Program 18.21 Tests the queue implementation, including its thread safety.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UseLinkedListQueue</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">THREADS</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">LinkedListQueue</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedListQueue</span><span class="o">();</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="n">adding</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Thread</span><span class="o">[]</span> <span class="n">threads</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">[</span><span class="n">THREADS</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">THREADS</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UseLinkedListQueue</span><span class="o">();</span>
            <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">start</span><span class="o">();</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="o">}</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">THREADS</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="k">try</span> <span class="o">{</span> <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">join</span><span class="o">();</span> <span class="o">}</span> <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>

        <span class="n">adding</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">THREADS</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UseLinkedListQueue</span><span class="o">();</span>
            <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">start</span><span class="o">();</span> <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="o">}</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">THREADS</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="k">try</span> <span class="o">{</span> <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">join</span><span class="o">();</span> <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{}</span>

        <span class="k">while</span><span class="o">(</span> <span class="o">!</span><span class="n">queue</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Left in queue: ID = &quot;</span> <span class="o">+</span>
                    <span class="n">queue</span><span class="o">.</span><span class="na">dequeue</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">adding</span> <span class="o">)</span> <span class="o">{</span>
            <span class="kt">long</span> <span class="n">ID</span> <span class="o">=</span> <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getId</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Thread ID added to queue: &quot;</span> <span class="o">+</span>
                    <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getId</span><span class="o">());</span>
            <span class="n">queue</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ID</span><span class="o">));</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">ID</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="na">dequeue</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Thread ID removed from queue: &quot;</span> <span class="o">+</span> <span class="n">ID</span><span class="o">);</span> <i class="conum" data-value="6"></i><b>(6)</b>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The program creates a queue and stores a reference
to it in a static (class) variable <code>queue</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It then creates and starts 10 threads.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>During the adding phase (indicated by <code>adding</code> being
<code>true</code>), each thread adds its thread ID number to the queue and prints
it to standard output.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Then, the program joins the threads until each
has finished.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The program ends the adding phase (by setting the
boolean variable <code>adding</code> to <code>false</code>) and starts 10 more threads.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>These
threads each read one value from the queue and print it to standard
output.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Without appropriate synchronization, the program may not correctly link
all values into the queue nor remove them at the end. A typical
error-prone output run is shown here:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Thread ID added to queue: 9
Thread ID added to queue: 14
Thread ID added to queue: 13
Thread ID added to queue: 12
Thread ID added to queue: 11
Thread ID added to queue: 10
Thread ID added to queue: 18
Thread ID added to queue: 17
Thread ID added to queue: 16
Thread ID added to queue: 15
Thread ID removed from queue: 14
Thread ID removed from queue: 11
Thread ID removed from queue: 12
Thread ID removed from queue: 16
Thread ID removed from queue: 17
Thread ID removed from queue: 18
Thread ID removed from queue: 10
Can't dequeue an empty queue!
Can't dequeue an empty queue!
Thread ID removed from queue: 15
Thread ID removed from queue: null
Thread ID removed from queue: null</pre>
</div>
</div>
<div class="paragraph">
<p>How does this implementation fail? Consider the situation in which two
threads are attempting to put a value in the queue simultaneously by calling the <code>enqueue()</code> methode in <a href="#LinkedListQueueProgram">Program 18.15</a>. Suppose
the first thread tests the queue and finds it empty (<code>isEmpty()</code> returns
<code>true</code>) but is then interrupted. If a second thread gets control it will
also see that the queue is empty then sets the <code>head</code> and <code>tail</code>
variables to the new <code>Node</code> object <code>temp</code> and
return. The first thread will eventually wake up, still thinking that
the queue is empty, and also set the <code>head</code> and <code>tail</code> variables to its
own new <code>Node</code> <code>temp</code>. But these assignments overwrite the assignments
just done by the previous thread! The initial node that was in the queue
is now lost.</p>
</div>
<div class="paragraph">
<p>This problem can be fixed by ensuring that once one thread starts
examining and modifying queue variables, no other thread can access the
same variables until the first one is finished. As shown in
<a href="chap13.html#ch14-synchronization">Chapter 14</a>, this mutual exclusion can be
achieved by using the <code>synchronized</code> keyword on methods that need to
have exclusive access to object variables. In this queue implementation,
we need to synchronize access by threads that are using either the
<code>enqueue()</code> or <code>dequeue()</code> methods, since both methods access and
manipulate variables in the object. Although it is not called in this
program, the <code>front()</code> method should also be synchronized so that a
<code>null</code> <code>head</code> is not accessed accidentally. The <code>isEmpty()</code> method does
not need to be synchronized since the only methods that call it that can
do any harm are already synchronized. Outside code that calls
<code>isEmpty()</code> might get the wrong value if another thread modifies the
contents of the queue, but there is no guarantee that other threads will
not modify the state of the queue at any point after the <code>isEmpty()</code>
method is called anyway.</p>
</div>
<div id="LinkedListQueueTSProgram" class="listingblock">
<div class="title">Program 18.22 Synchronized version of the queue class that allows thread-safe use.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedListQueueTS</span> <span class="kd">implements</span> <span class="n">Queue</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">head</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span> <span class="n">tail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Node</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="n">temp</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span><span class="o">(</span> <span class="n">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">tail</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="n">String</span> <span class="nf">dequeue</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Can't dequeue an empty queue!&quot;</span><span class="o">);</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
            <span class="k">if</span><span class="o">(</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span>
                <span class="n">tail</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="n">String</span> <span class="nf">front</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">isEmpty</span><span class="o">()</span> <span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;No front on an empty queue!&quot;</span><span class="o">);</span>
        <span class="k">else</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">head</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With both <code>enqueue()</code> and <code>dequeue()</code> methods synchronized as in
<a href="#LinkedListQueueTSProgram">Program 18.22</a>, a typical output generated by the
program is shown below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Thread ID added to queue: 9
Thread ID added to queue: 14
Thread ID added to queue: 12
Thread ID added to queue: 13
Thread ID added to queue: 10
Thread ID added to queue: 11
Thread ID added to queue: 18
Thread ID added to queue: 17
Thread ID added to queue: 16
Thread ID added to queue: 15
Thread ID removed from queue: 9
Thread ID removed from queue: 18
Thread ID removed from queue: 13
Thread ID removed from queue: 17
Thread ID removed from queue: 15
Thread ID removed from queue: 16
Thread ID removed from queue: 14
Thread ID removed from queue: 12
Thread ID removed from queue: 10
Thread ID removed from queue: 11</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_concurrency_thread_safe_libraries">18.8. Concurrency: Thread-safe libraries</h3>
<div class="paragraph">
<p>As we mentioned in <a href="chap8.html#_concurrency_objects">Section 9.7</a>, some libraries are
thread-safe and some are not. The Java Collections Framework (JCF) is a
very useful library, but it is also a library that requires thread
safety to be at the forefront of your mind.</p>
</div>
<div class="paragraph">
<p>The JCF defines the <code>Collection</code> interface and the <code>Map</code> interface. The
<code>Collection</code> interface, which any collection of objects should
implement, has subinterfaces <code>Set</code>, <code>List</code>, and <code>Queue</code> which define the
basic operations in Java that are needed to implement a set, list, or
queue of items. The <code>Map</code> interface gives the basic operations for a
dictionary, a collection of key-value pairs, one implementation of which
is the <code>HashMap</code> from <a href="#mapsExample">Example 18.4</a>.</p>
</div>
<div class="paragraph">
<p>As we mentioned in <a href="chap9.html#ch10-interfaces">Chapter 10</a>, an interface cannot
mark a method with the <code>synchronized</code> keyword. Consequently, the JCF can
make no guarantee about the thread safety of a container based on which
interface it implements. The programmer must read the documentation
carefully in order to know if a container is thread-safe and react
accordingly.</p>
</div>
<div class="exampleblock">
<div class="title">Example 18.5 ArrayList</div>
<div class="content">
<div class="paragraph">
<p>An <code>ArrayList</code> is like a <code>Vector</code>, with essentially the same interface
but lacks synchronization. That is, if two threads attempt to insert or
remove an element from the same <code>ArrayList</code> at the same time, the
<code>ArrayList</code> internal state may become corrupt or the results may be
incorrect.</p>
</div>
<div class="paragraph">
<p><a href="#ArrayListExampleProgram">Program 18.23</a> is an example of synchronizing
updates to the <code>ArrayList</code> class with multiple threads.</p>
</div>
<div id="ArrayListExampleProgram" class="listingblock">
<div class="title">Program 18.23 Example of thread-safe use of an <code>ArrayList</code>.</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArrayListExample</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span> <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="n">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayListExample</span><span class="o">();</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="n">Thread</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayListExample</span><span class="o">();</span>
        <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">t2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">t1</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
            <span class="n">t2</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span> <span class="o">}</span>

        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">list</span><span class="o">)</span> <span class="o">{</span> <i class="conum" data-value="4"></i><b>(4)</b>
                <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">try</span> <span class="o">{</span> <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>  <span class="o">}</span>
            <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The program creates an <code>ArrayList</code> and places a reference to it in the static class variable <code>list</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It then creates and starts two threads.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Each thread repeats a loop 10 times, appending a <code>String</code> to the <code>ArrayList</code> on each iteration. To increase the likelihood of concurrent update attempts, the thread sleeps for a millisecond on each iteration.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>To prevent concurrent updates from actually happening, each thread synchronizes on the shared class variable <code>list</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Without</strong> the <code>synchronized</code> keyword, a typical run, shown below,
includes a <code>null</code> reference in the output, indicating that the internal
<code>ArrayList</code> data structure was not updated correctly.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Thread-1: 0
Thread-0: 0
Thread-1: 1
Thread-0: 1
Thread-1: 2
Thread-0: 2
Thread-0: 3
Thread-1: 3
Thread-1: 4
Thread-0: 4
null
Thread-0: 5
Thread-1: 6
Thread-0: 6
Thread-1: 7
Thread-0: 7
Thread-1: 8
Thread-0: 8
Thread-0: 9
Thread-1: 9</pre>
</div>
</div>
<div class="paragraph">
<p><strong>With</strong> the <code>synchronized</code> keyword, each run includes exactly the same
number of entries from each thread, although the threads do not always
alternate in strict lock-step.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Thread-0: 0
Thread-1: 0
Thread-0: 1
Thread-1: 1
Thread-1: 2
Thread-0: 2
Thread-1: 3
Thread-0: 3
Thread-1: 4
Thread-0: 4
Thread-0: 5
Thread-1: 5
Thread-1: 6
Thread-0: 6
Thread-1: 7
Thread-0: 7
Thread-1: 8
Thread-0: 8
Thread-1: 9
Thread-0: 9</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercises_18">18.9. Exercises</h3>
<div class="paragraph">
<p><strong>Conceptual Problems</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explain the difference between static data structures and dynamic
data structures.</p>
</li>
<li>
<p>In which situations is it better to use a dynamic array? In which
situations is it better to use a linked list? Explain why in each case.</p>
</li>
<li>
<p><a id="fixedArrayExceptionExercise"></a> On which line in
<a href="#ReadIntoFixedArrayProgram">Program 18.1</a> is an exception generated?</p>
</li>
<li>
<p><a id="alternateGrowArrayExercise"></a> In
<a href="#ReadAndGrowArrayProgram">Program 18.2</a>, is it possible to post-increment
<code>n</code> inside the <code>try</code> clause rather than at the bottom of the <code>while</code>
loop?</p>
</li>
<li>
<p><a id="threeQuarterFullArrayExercise"></a> Explain why the <code>names</code> array in
<a href="#UseDynamicArrayProgram">Program 18.4</a> is, on average, only three-quarters
full.</p>
</li>
<li>
<p>Based on the stack implementation in
<a href="#LinkedListStackProgram">Program 18.10</a>, draw a picture of the linked list
structure after each of the following statements.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="n">LinkedListStack</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedListStack</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;goodbye&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;there&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;cruel&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">&quot;world&quot;</span><span class="o">);</span></code></pre>
</div>
</div>
</li>
<li>
<p><a id="stackMethodsExercise"></a> Implement the methods <code>top()</code> and
<code>isEmpty()</code> for the dynamic array implementation of the stack in
<a href="#DynamicArrayStackProgram">Program 18.11</a>.</p>
</li>
<li>
<p>Based on queue implementation in
<a href="#LinkedListQueueProgram">Program 18.15</a>, draw a picture of the linked list
structure after each of the following statements.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java">    <span class="n">LinkedListStack</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedListStack</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="s">&quot;there&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="s">&quot;world&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">dequeue</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="s">&quot;cruel&quot;</span><span class="o">);</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">dequeue</span><span class="o">();</span>
    <span class="n">stack</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="s">&quot;goodbye&quot;</span><span class="o">);</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Programming Practice</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p><a id="shrinkingDynamicArrayExercise"></a> Implement a version of
<code>DynamicArray</code> that shrinks the size of its internal storage array to
half its size when only one quarter of its capacity is being used. This
design can save significant amounts of space if a large number of items
are added to the dynamic array at once and then removed.</p>
</li>
<li>
<p>Consider <a href="#LinkedListWithTailProgram">Program 18.7</a> which defines the
<code>LinkedListWithTail</code> class for storing a linked list of <code>String</code> values.
Add a <code>public reverse()</code> method to the class which reverses the order of
the nodes in the linked list. The key idea is make a new linked list
that holds the head of the list. Then, remove the head from the original
linked list. Put the next node <strong>in front</strong> of the head in the new linked
list and remove it from the old. Continue the process until there is
nothing left in the original list. Be sure to reset the <code>head</code> and
<code>tail</code> references correctly after the reversal.</p>
</li>
<li>
<p>In <a href="#_linked_lists">Section 18.2.2</a>, we use two kinds of linked
lists to store data, but copy all of that data back into an array before
sorting it. We use third linked list class (<code>SortedLinkedList</code>) to
insert data and maintain a sorted order. However, it is possible to add
data in non-sorted order to a linked list and then sort it afterwards.
Add a <code>sort()</code> method to the <code>LinkedListWithTail</code> class that performs a
bubble sort on the nodes inside.</p>
<div class="paragraph">
<p>The algorithm for a bubble sort is described in <a href="chap9.html#_problem_sort_it_out">Section 10.1</a>. The idea is to make repeated passes through a list, swapping
two adjacent items if they are out of order. You keep making passes over
the list until no adjacent items are out of order. For a this <code>sort()</code>
method, you will need to use the <code>compareTo()</code> method to compare the
<code>String</code> values in the linked list nodes. Also, it may be necessary to
have special cases that update the <code>head</code> and <code>tail</code> pointers if those
nodes are swapped with other nodes. Note that bubble sort is not the
fastest way to sort a linked list. We introduce a faster approach in
<a href="chap18.html#ch19-recursion">Chapter 19</a>.</p>
</div>
</li>
<li>
<p><a id="testUnsynchronizedDynamicArrayExercise"></a> Create JUnit test cases to
verify that the <code>synchronized</code> keywords are needed on the <code>set()</code> and
<code>sort()</code> methods of the <code>DynamicArray</code> example from <a href="#DynamicArrayProgram">Program 18.3</a>. To test the <code>set()</code> method, you can
create one thread that repeatedly sets, gets, and tests a changing value
at a fixed location (e.g., 0) and another thread that continuously
appends to the array (causing it to grow by copy and replace, thus
occasionally overwriting the value at the fixed location). To test the
<code>sort()</code> method, create two threads that sort the same large random
array at the same time. Check to see if the array is, in fact, actually
sorted after the threads have exited. For both tests, you may need to
repeat the operations a number of times to trigger the race condition.</p>
</li>
<li>
<p>To make an infix calculator that can handle floating-point values or
even just integers with more than one digit, you need to make a pass
over the input, parsing the sequence of characters into terms. When an
expression is in infix notation, the order of terms is an operand
followed by an operator, repeated over and over, and finishing on an
operand. There are two exceptions: Whenever you are expecting an
operand, you might get a left parenthesis, but, after the parenthesis,
you continue to look for an operand. Whenever you are expecting an
operator, you might get a right parenthesis, but, after that
parenthesis, you continue to look for an operator.</p>
<div class="paragraph">
<p>Using this first pass over input to separate terms as well as the
<code>parseDouble()</code> method from <a href="chap7.html#parsingANumberExample">Example 8.3</a> to
compute the equivalent <code>double</code> values of operands, rewrite the solution
from <a href="#_solution_infix_conversion">Section 18.6</a> to convert your terms into
postfix ordering and then calculate the answer.</p>
</div>
</li>
<li>
<p>Re-implement the solution to the infix conversion problem given in
<a href="#_solution_infix_conversion">Section 18.6</a> so that it uses <code>GenericStack</code>
with a type parameter of <code>Term</code> instead of <code>TermStack</code>.</p>
</li>
<li>
<p>Interfaces can also be generic. Consider the following generic
version of <code>Queue</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">T</span> <span class="n">value</span><span class="o">);</span>
    <span class="n">T</span> <span class="nf">dequeue</span><span class="o">();</span>
    <span class="n">T</span> <span class="nf">front</span><span class="o">();</span>
    <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Re-implement <code>LinkedListQueue</code> so that it is generic with type parameter
<code>T</code> and implements interface <code>Queue&lt;T&gt;</code>.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div></div>
<div id="footer">
<div id="footer-text">
Last updated 2019-06-12 16:22:41 UTC
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #000000;
  background-color: #f8f8f8;
}
pre.rouge .c, pre.rouge .cd, pre.rouge .cm, pre.rouge .c1, pre.rouge .cs {
  color: #408080;
  font-style: italic;
}
pre.rouge .cp {
  color: #BC7A00;
}
pre.rouge .k, pre.rouge .kc, pre.rouge .kd, pre.rouge .kn, pre.rouge .kr, pre.rouge .kv {
  color: #008000;
  font-weight: bold;
}
pre.rouge .kp {
}
pre.rouge .kt {
  color: #B00040;
}
pre.rouge .o {
  color: #666666;
}
pre.rouge .ow {
  color: #AA22FF;
  font-weight: bold;
}
pre.rouge .nb, pre.rouge .bp {
  color: #008000;
}
pre.rouge .nf {
  color: #0000FF;
}
pre.rouge .nc {
  color: #0000FF;
  font-weight: bold;
}
pre.rouge .nn {
  color: #0000FF;
  font-weight: bold;
}
pre.rouge .ne {
  color: #D2413A;
  font-weight: bold;
}
pre.rouge .nv, pre.rouge .vc, pre.rouge .vg, pre.rouge .vi {
  color: #19177C;
}
pre.rouge .no {
  color: #880000;
}
pre.rouge .nl {
  color: #A0A000;
}
pre.rouge .ni {
  color: #999999;
  font-weight: bold;
}
pre.rouge .na {
  color: #7D9029;
}
pre.rouge .nt {
  color: #008000;
  font-weight: bold;
}
pre.rouge .nd {
  color: #AA22FF;
}
pre.rouge .s, pre.rouge .sb, pre.rouge .sc, pre.rouge .s2, pre.rouge .sh, pre.rouge .s1 {
  color: #BA2121;
}
pre.rouge .sd {
  font-style: italic;
}
pre.rouge .si {
  color: #BB6688;
  font-weight: bold;
}
pre.rouge .se {
  color: #BB6622;
  font-weight: bold;
}
pre.rouge .sr {
  color: #BB6688;
}
pre.rouge .ss {
  color: #19177C;
}
pre.rouge .sx {
  color: ##008000;
}
pre.rouge .m, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mb, pre.rouge .mx {
  color: #666666;
}
pre.rouge .gh {
  color: #000080;
  font-weight: bold;
}
pre.rouge .gu {
  color: #800080;
  font-weight: bold;
}
pre.rouge .gd {
  color: #A00000;
}
pre.rouge .gi {
  color: #00A000;
}
pre.rouge .gr {
  color: ##FF0000;
}
pre.rouge .ge {
  font-style: italic;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gp {
  color: #000080;
  font-weight: bold;
}
pre.rouge .go {
  color: #888;
}
pre.rouge .gt {
  color: #04D;
}
pre.rouge .err {
  color: #F00;
  background-color: #FAA;
}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-129929421-1','auto');
ga('send','pageview');
</script>
</body>
</html>