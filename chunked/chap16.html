<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="author" content="Barry Wittman, Tim Korb, Aditya Mathur">
<title>Start Concurrent: A Gentle Introduction to Concurrent Programming</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Start Concurrent: A Gentle Introduction to Concurrent Programming</h1>
<div class="details">
<span id="author" class="author">Barry Wittman</span><br>
<span id="email" class="email"><a href="mailto:wittman1@otterbein.edu">wittman1@otterbein.edu</a></span><br>
<span id="author2" class="author">Tim Korb</span><br>
<span id="email2" class="email"><a href="mailto:jtk@purdue.edu">jtk@purdue.edu</a></span><br>
<span id="author3" class="author">Aditya Mathur</span><br>
<span id="email3" class="email"><a href="mailto:apm@purdue.edu">apm@purdue.edu</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html#ch01-computer-basics">1. Computer Basics</a>
<ul class="sectlevel2">
<li><a href="index.html#_problem_buying_a_computer">1.1. Problem: Buying a computer</a></li>
<li><a href="index.html#_concepts_hardware_and_software">1.2. Concepts: Hardware and software</a></li>
<li><a href="index.html#_syntax_data_representation">1.3. Syntax: Data representation</a></li>
<li><a href="index.html#_solution_buying_a_computer">1.4. Solution: Buying a computer</a></li>
<li><a href="index.html#_summary">1.5. Summary</a></li>
<li><a href="index.html#_exercises">1.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap1.html#ch02-intro">2. Problem Solving and Programming</a>
<ul class="sectlevel2">
<li><a href="chap1.html#_problem_how_to_solve_problems">2.1. Problem: How to solve problems</a></li>
<li><a href="chap1.html#_concepts_developing_software">2.2. Concepts: Developing software</a></li>
<li><a href="chap1.html#_syntax_java_basics">2.3. Syntax: Java basics</a></li>
<li><a href="chap1.html#_solution_how_to_solve_problems">2.4. Solution: How to solve problems</a></li>
<li><a href="chap1.html#_concurrency_solving_problems_in_parallel">2.5. Concurrency: Solving problems in parallel</a></li>
<li><a href="chap1.html#_summary_2">2.6. Summary</a></li>
<li><a href="chap1.html#_exercises_2">2.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap2.html#ch03-strings-primitive-types">3. Primitive Types and Strings</a>
<ul class="sectlevel2">
<li><a href="chap2.html#_problem_college_cost_calculator">3.1. Problem: College cost calculator</a></li>
<li><a href="chap2.html#_concepts_types">3.2. Concepts: Types</a></li>
<li><a href="chap2.html#_syntax_types_in_java">3.3. Syntax: Types in Java</a></li>
<li><a href="chap2.html#_syntax_useful_libraries">3.4. Syntax: Useful libraries</a></li>
<li><a href="chap2.html#_solution_college_cost_calculator">3.5. Solution: College cost calculator</a></li>
<li><a href="chap2.html#_concurrency_expressions">3.6. Concurrency: Expressions</a></li>
<li><a href="chap2.html#_summary_3">3.7. Summary</a></li>
<li><a href="chap2.html#_exercises_3">3.8. Exercises</a></li>
</ul>
</li>
<li><a href="chap3.html#ch04-selection">4. Selection</a>
<ul class="sectlevel2">
<li><a href="chap3.html#_problem_monty_hall_simulation">4.1. Problem: Monty Hall simulation</a></li>
<li><a href="chap3.html#_concepts_choosing_between_options">4.2. Concepts: Choosing between options</a></li>
<li><a href="chap3.html#_syntax_selection_in_java">4.3. Syntax: Selection in Java</a></li>
<li><a href="chap3.html#_solution_monty_hall">4.4. Solution: Monty Hall</a></li>
<li><a href="chap3.html#_concurrency_selection">4.5. Concurrency: Selection</a></li>
<li><a href="chap3.html#_exercises_4">4.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap4.html#ch05-repetition">5. Repetition</a>
<ul class="sectlevel2">
<li><a href="chap4.html#_problem_dna_searching">5.1. Problem: DNA searching</a></li>
<li><a href="chap4.html#_concepts_repetition">5.2. Concepts: Repetition</a></li>
<li><a href="chap4.html#_syntax_loops_in_java">5.3. Syntax: Loops in Java</a></li>
<li><a href="chap4.html#_solution_dna_searching">5.4. Solution: DNA searching</a></li>
<li><a href="chap4.html#_concurrency_loops">5.5. Concurrency: Loops</a></li>
<li><a href="chap4.html#_exercises_5">5.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap5.html#ch06-arrays">6. Arrays</a>
<ul class="sectlevel2">
<li><a href="chap5.html#_introduction">6.1. Introduction</a></li>
<li><a href="chap5.html#_problem_game_of_life">6.2. Problem: Game of Life</a></li>
<li><a href="chap5.html#_concepts_lists_of_data">6.3. Concepts: Lists of data</a></li>
<li><a href="chap5.html#_syntax_arrays_in_java">6.4. Syntax: Arrays in Java</a></li>
<li><a href="chap5.html#_examples_array_usage">6.5. Examples: Array usage</a></li>
<li><a href="chap5.html#_concepts_multidimensional_lists">6.6. Concepts: Multidimensional lists</a></li>
<li><a href="chap5.html#_syntax_advanced_arrays_in_java">6.7. Syntax: Advanced arrays in Java</a></li>
<li><a href="chap5.html#_examples_two_dimensional_arrays">6.8. Examples: Two-dimensional arrays</a></li>
<li><a href="chap5.html#_advanced_special_array_tools_in_java">6.9. Advanced: Special array tools in Java</a></li>
<li><a href="chap5.html#_solution_game_of_life">6.10. Solution: Game of Life</a></li>
<li><a href="chap5.html#_concurrency_arrays">6.11. Concurrency: Arrays</a></li>
<li><a href="chap5.html#_exercises_6">6.12. Exercises</a></li>
</ul>
</li>
<li><a href="chap6.html#ch07-gui-basics">7. Simple Graphical User Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap6.html#_problem_codon_extractor">7.1. Problem: Codon extractor</a></li>
<li><a href="chap6.html#GUIBasicsIntroductionSection">7.2. Concepts: User interaction</a></li>
<li><a href="chap6.html#_syntax_dialogs_and_the_joptionpane_class">7.3. Syntax: Dialogs and the <code>JOptionPane</code> class</a></li>
<li><a href="chap6.html#_solution_codon_extractor">7.4. Solution: Codon extractor</a></li>
<li><a href="chap6.html#_concurrency_simple_guis">7.5. Concurrency: Simple GUIs</a></li>
<li><a href="chap6.html#_summary_4">7.6. Summary</a></li>
<li><a href="chap6.html#_exercises_7">7.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap7.html#ch08-methods">8. Methods</a>
<ul class="sectlevel2">
<li><a href="chap7.html#_problem_three_card_poker">8.1. Problem: Three card poker</a></li>
<li><a href="chap7.html#_concepts_dividing_work_into_segments">8.2. Concepts: Dividing work into segments</a></li>
<li><a href="chap7.html#_syntax_methods">8.3. Syntax: Methods</a></li>
<li><a href="chap7.html#_examples_defining_methods">8.4. Examples: Defining methods</a></li>
<li><a href="chap7.html#_solution_three_card_poker">8.5. Solution: Three card poker</a></li>
<li><a href="chap7.html#_concurrency_methods">8.6. Concurrency: Methods</a></li>
<li><a href="chap7.html#_exercises_8">8.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap8.html#ch09-classes">9. Classes</a>
<ul class="sectlevel2">
<li><a href="chap8.html#_problem_nested_expressions">9.1. Problem: Nested expressions</a></li>
<li><a href="chap8.html#_concepts_object_oriented_programming">9.2. Concepts: Object-oriented programming</a></li>
<li><a href="chap8.html#_syntax_classes_in_java">9.3. Syntax: Classes in Java</a></li>
<li><a href="chap8.html#_examples_classes">9.4. Examples: Classes</a></li>
<li><a href="chap8.html#_advanced_nested_classes">9.5. Advanced: Nested classes</a></li>
<li><a href="chap8.html#_solution_nested_expressions">9.6. Solution: Nested expressions</a></li>
<li><a href="chap8.html#_concurrency_objects">9.7. Concurrency: Objects</a></li>
<li><a href="chap8.html#_exercises_9">9.8. Exercises</a></li>
</ul>
</li>
<li><a href="chap9.html#ch10-interfaces">10. Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap9.html#_problem_sort_it_out">10.1. Problem: Sort it out</a></li>
<li><a href="chap9.html#_concepts_making_a_promise">10.2. Concepts: Making a promise</a></li>
<li><a href="chap9.html#_syntax_interfaces">10.3. Syntax: Interfaces</a></li>
<li><a href="chap9.html#_advanced_local_and_anonymous_classes">10.4. Advanced: Local and anonymous classes</a></li>
<li><a href="chap9.html#_solution_sort_it_out">10.5. Solution: Sort it out</a></li>
<li><a href="chap9.html#_concurrency_interfaces">10.6. Concurrency: Interfaces</a></li>
<li><a href="chap9.html#_exercises_10">10.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap10.html#ch11-inheritance">11. Inheritance</a>
<ul class="sectlevel2">
<li><a href="chap10.html#_problem_boolean_circuits">11.1. Problem: Boolean circuits</a></li>
<li><a href="chap10.html#_concepts_refining_classes">11.2. Concepts: Refining classes</a></li>
<li><a href="chap10.html#_syntax_inheritance_in_java">11.3. Syntax: Inheritance in Java</a></li>
<li><a href="chap10.html#_examples_problem_solving_with_inheritance">11.4. Examples: Problem solving with inheritance</a></li>
<li><a href="chap10.html#_solution_boolean_circuits">11.5. Solution: Boolean circuits</a></li>
<li><a href="chap10.html#_concurrency_inheritance">11.6. Concurrency: Inheritance</a></li>
<li><a href="chap10.html#_exercises_11">11.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap11.html#ch12-exceptions">12. Exceptions</a>
<ul class="sectlevel2">
<li><a href="chap11.html#_problem_bank_burglary">12.1. Problem: Bank burglary</a></li>
<li><a href="chap11.html#_concepts_error_handling">12.2. Concepts: Error handling</a></li>
<li><a href="chap11.html#_syntax_exceptions_in_java">12.3. Syntax: Exceptions in Java</a></li>
<li><a href="chap11.html#_solution_bank_burglary">12.4. Solution: Bank burglary</a></li>
<li><a href="chap11.html#_concurrency_exceptions">12.5. Concurrency: Exceptions</a></li>
<li><a href="chap11.html#_exercises_12">12.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap12.html#ch13-concurrency">13. Concurrent Programming</a>
<ul class="sectlevel2">
<li><a href="chap12.html#_introduction_2">13.1. Introduction</a></li>
<li><a href="chap12.html#_problem_deadly_virus">13.2. Problem: Deadly virus</a></li>
<li><a href="chap12.html#_concepts_splitting_up_work">13.3. Concepts: Splitting up work</a></li>
<li><a href="chap12.html#_syntax_threads_in_java">13.4. Syntax: Threads in Java</a></li>
<li><a href="chap12.html#_examples_concurrency_and_speedup">13.5. Examples: Concurrency and speedup</a></li>
<li><a href="chap12.html#_concepts_thread_scheduling">13.6. Concepts: Thread scheduling</a></li>
<li><a href="chap12.html#_syntax_thread_states">13.7. Syntax: Thread states</a></li>
<li><a href="chap12.html#_solution_deadly_virus">13.8. Solution: Deadly virus</a></li>
<li><a href="chap12.html#_summary_5">13.9. Summary</a></li>
<li><a href="chap12.html#_exercises_13">13.10. Exercises</a></li>
</ul>
</li>
<li><a href="chap13.html#ch14-synchronization">14. Synchronization</a>
<ul class="sectlevel2">
<li><a href="chap13.html#_introduction_3">14.1. Introduction</a></li>
<li><a href="chap13.html#_problem_dining_philosophers">14.2. Problem: Dining philosophers</a></li>
<li><a href="chap13.html#_concepts_thread_interaction">14.3. Concepts: Thread interaction</a></li>
<li><a href="chap13.html#_syntax_thread_synchronization">14.4. Syntax: Thread synchronization</a></li>
<li><a href="chap13.html#_pitfalls_synchronization_challenges">14.5. Pitfalls: Synchronization challenges</a></li>
<li><a href="chap13.html#_solution_dining_philosophers">14.6. Solution: Dining philosophers</a></li>
<li><a href="chap13.html#_exercises_14">14.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap14.html#ch15-gui">15. Constructing Graphical User Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap14.html#_problem_math_applet">15.1. Problem: Math applet</a></li>
<li><a href="chap14.html#_concepts_graphical_user_interfaces">15.2. Concepts: Graphical user interfaces</a></li>
<li><a href="chap14.html#_syntax_guis_in_java">15.3. Syntax: GUIs in Java</a></li>
<li><a href="chap14.html#_solution_math_applet">15.4. Solution: Math applet</a></li>
<li><a href="chap14.html#_concurrency_guis">15.5. Concurrency: GUIs</a></li>
<li><a href="chap14.html#_summary_6">15.6. Summary</a></li>
<li><a href="chap14.html#_exercises_15">15.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap15.html#ch16-testing-and-debugging">16. Testing and Debugging</a>
<ul class="sectlevel2">
<li><a href="chap15.html#_fixing_bugs">16.1. Fixing bugs</a></li>
<li><a href="chap15.html#_concepts_approaches_to_debugging">16.2. Concepts: Approaches to debugging</a></li>
<li><a href="chap15.html#_syntax_java_debugging_tools">16.3. Syntax: Java debugging tools</a></li>
<li><a href="chap15.html#_concurrency_parallel_bugs">16.4. Concurrency: Parallel bugs</a></li>
<li><a href="chap15.html#_finding_and_avoiding_bugs">16.5. Finding and avoiding bugs</a></li>
<li><a href="chap15.html#_concepts_design_implementation_and_testing">16.6. Concepts: Design, implementation, and testing</a></li>
<li><a href="chap15.html#_syntax_java_testing_tools">16.7. Syntax: Java testing tools</a></li>
<li><a href="chap15.html#_concurrency_testing_tools">16.8. Concurrency: Testing tools</a></li>
<li><a href="chap15.html#_examples_testing_a_class">16.9. Examples: Testing a class</a></li>
<li><a href="chap15.html#_exercises_16">16.10. Exercises</a></li>
</ul>
</li>
<li><a href="#ch17-polymorphism">17. Polymorphism</a>
<ul class="sectlevel2">
<li><a href="#_problem_banking_account_with_a_vengeance">17.1. Problem: Banking account with a vengeance</a></li>
<li><a href="#_concepts_polymorphism">17.2. Concepts: Polymorphism</a></li>
<li><a href="#_syntax_inheritance_tools_in_java">17.3. Syntax: Inheritance tools in Java</a></li>
<li><a href="#_solution_banking_account_with_a_vengeance">17.4. Solution: Banking account with a vengeance</a></li>
<li><a href="#_concurrency_atomic_libraries">17.5. Concurrency: Atomic libraries</a></li>
<li><a href="#_exercises_17">17.6. Exercises</a></li>
</ul>
</li>
<li><a href="chap17.html#ch18-dynamic-data-structures">18. Dynamic Data Structures</a>
<ul class="sectlevel2">
<li><a href="chap17.html#_problem_infix_conversion">18.1. Problem: Infix conversion</a></li>
<li><a href="chap17.html#_concepts_dynamic_data_structures">18.2. Concepts: Dynamic data structures</a></li>
<li><a href="chap17.html#_syntax_dynamic_arrays_and_linked_lists">18.3. Syntax: Dynamic arrays and linked lists</a></li>
<li><a href="chap17.html#_syntax_abstract_data_types_adt">18.4. Syntax: Abstract data types (ADT)</a></li>
<li><a href="chap17.html#_advanced_generic_data_structures">18.5. Advanced: Generic data structures</a></li>
<li><a href="chap17.html#_solution_infix_conversion">18.6. Solution: Infix conversion</a></li>
<li><a href="chap17.html#_concurrency_linked_lists_and_thread_safety">18.7. Concurrency: Linked lists and thread safety</a></li>
<li><a href="chap17.html#_concurrency_thread_safe_libraries">18.8. Concurrency: Thread-safe libraries</a></li>
<li><a href="chap17.html#_exercises_18">18.9. Exercises</a></li>
</ul>
</li>
<li><a href="chap18.html#ch19-recursion">19. Recursion</a>
<ul class="sectlevel2">
<li><a href="chap18.html#_problem_maze_of_doom">19.1. Problem: Maze of doom</a></li>
<li><a href="chap18.html#_concepts_recursive_problem_solving">19.2. Concepts: Recursive problem solving</a></li>
<li><a href="chap18.html#_syntax_recursive_methods">19.3. Syntax: Recursive methods</a></li>
<li><a href="chap18.html#_syntax_recursive_data_structures">19.4. Syntax: Recursive data structures</a></li>
<li><a href="chap18.html#_solution_maze_of_doom">19.5. Solution: Maze of doom</a></li>
<li><a href="chap18.html#_concurrency_futures">19.6. Concurrency: Futures</a></li>
<li><a href="chap18.html#_exercises_19">19.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap19.html#ch20-file-io">20. File I/O</a>
<ul class="sectlevel2">
<li><a href="chap19.html#_problem_a_picture_is_worth_1000_bytes">20.1. Problem: A picture is worth 1,000 bytes</a></li>
<li><a href="chap19.html#_concepts_file_io">20.2. Concepts: File I/O</a></li>
<li><a href="chap19.html#_syntax_file_operations_in_java">20.3. Syntax: File operations in Java</a></li>
<li><a href="chap19.html#_examples_file_examples">20.4. Examples: File examples</a></li>
<li><a href="chap19.html#_solution_a_picture_is_worth_1000_bytes">20.5. Solution: A picture is worth 1,000 bytes</a></li>
<li><a href="chap19.html#_concurrency_file_io">20.6. Concurrency: File I/O</a></li>
<li><a href="chap19.html#_exercises_20">20.7. Exercises</a></li>
</ul>
</li>
<li><a href="chap20.html#ch21-network-communication">21. Network Communication</a>
<ul class="sectlevel2">
<li><a href="chap20.html#_problem_web_server">21.1. Problem: Web server</a></li>
<li><a href="chap20.html#_concepts_tcpip_communication">21.2. Concepts: TCP/IP communication</a></li>
<li><a href="chap20.html#_syntax_networking_in_java">21.3. Syntax: Networking in Java</a></li>
<li><a href="chap20.html#_solution_web_server">21.4. Solution: Web server</a></li>
<li><a href="chap20.html#_concurrency_networking">21.5. Concurrency: Networking</a></li>
<li><a href="chap20.html#_exercises_21">21.6. Exercises</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content"><div class="sect1">
<h2 id="ch17-polymorphism">17. Polymorphism</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>…​how strange it is to be anything at all.</p>
</div>
</blockquote>
<div class="attribution">
— Neutral Milk Hotel
</div>
</div>
<div class="sect2">
<h3 id="_problem_banking_account_with_a_vengeance">17.1. Problem: Banking account with a vengeance</h3>
<div class="paragraph">
<p>In <a href="chap13.html#ch14-synchronization">Chapter 14</a>, we introduced the
<code>SynchronizedAccount</code> class that guarantees that checking the balance,
making deposits, and making withdrawals will all be safe even in a
multi-threaded environment. Unfortunately, <code>SynchronizedAccount</code> gives
very few of the options a full bank account should have. The problem we
present to you now is to create an entire line of bank accounts which
all inherit from <code>SynchronizedAccount</code>. Because of inheritance, all
accounts will at least have <code>getBalance()</code>, <code>deposit()</code>, and
<code>withdraw()</code> methods.</p>
</div>
<div class="paragraph">
<p>You must create three new account classes. The constructor for each
class must take a <code>String</code> which gives the name of the person opening
the account and <code>double</code> which gives the starting balance of the
account. The first of these classes is <code>CheckingAccount</code>. The rules for
the checking account implemented by this class are simply that the
customer is charged $10 every month that the account is open. The second
class is <code>DirectDepositAccount</code>. This account is very similar to the
basic checking account except that an additional method
<code>directDeposit()</code> has been added. On its own, <code>directDeposit()</code> appears
to operate like <code>deposit()</code>; however, if a direct deposit has been made
in the last month, no service fee will be charged to the account.</p>
</div>
<div class="paragraph">
<p>The <code>SavingsAccount</code> class operates somewhat differently. In addition to
a name and a starting balance, the constructor for a <code>SavingsAccount</code>
takes a <code>double</code> which gives the annual interest rate the account earns.
Each month the balance is checked. If the balance of the account is
greater than $0, the account earns interest corresponding to
\(\frac{1}{12}\) of the annual rate. However, if the balance
is below $1000, a $25 service fee is charged each month, regardless of
how low the balance becomes.</p>
</div>
<div class="paragraph">
<p>In <a href="chap10.html#ch11-inheritance">Chapter 11</a> you were exposed to concepts in
inheritance. We are now returning to these concepts and exploring them
further. In the first place, concurrency is on the table now, and you
must be careful to keep your derived classes thread-safe. In the second,
we will discuss the full breadth of inheritance. The tools we discuss
are intended to allow you to solve this extended bank account problem
and indeed many other problems with as little code as possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_concepts_polymorphism">17.2. Concepts: Polymorphism</h3>
<div class="paragraph">
<p>Perhaps the most important use for inheritance is code reuse. When you
can successfully reuse existing code, you are not just saving the time
of writing new code: You are also leveraging the quality and correctness
of the existing code. For example, when you create your own class which
extends <code>Thread</code>, you are confident that all the thread mechanisms work
properly.</p>
</div>
<div class="paragraph">
<p>You can reuse code by taking a class that does something you like, say
the <code>Racecar</code> class, and enhance it in some way, perhaps so that it
becomes the <code>TurboRacecar</code> class. If you use the <code>TurboRacecar</code> class on
its own, your code reuse is through simple inheritance. If you use
<code>TurboRacecar</code> objects with a <code>RaceTrack</code> class, which was written to
take <code>Racecar</code> objects as input, you have entered the realm of
<em>polymorphism</em>. Polymorphism means that the same method can be used on
different types of objects without being rewritten. In Java,
polymorphism works by allowing the programmer to use a derived class in
any place where a base class could have been used.</p>
</div>
<div class="sect3">
<h4 id="_the_is_a_relationship">17.2.1. The is-a relationship</h4>
<div class="paragraph">
<p>Consider the two following class definitions:</p>
</div>
<div id="RacecarProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Racecar</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-nf">getTopSpeed</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-mf">200.0</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">3 </span>    <span class="tok-kd">public</span> <span class="tok-kt">int</span> <span class="tok-nf">getHorsepower</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-mi">700</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">4 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-n">speed</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span>
<span class="lineno">5 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div id="TurboRacecarProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">TurboRacecar</span> <span class="tok-kd">extends</span> <span class="tok-n">Racecar</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">int</span> <span class="tok-nf">getHorsepower</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-mi">1100</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">3 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, imagine that a <code>RaceTrack</code> has an <code>addCar(Racecar car)</code> method
which adds a <code>Racecar</code> to the list of cars on the track. When the cars
begin racing, the <code>RaceTrack</code> object will query the cars to see how much
horsepower they have. A <code>Racecar</code> object will return 700 when
<code>getHorsepower()</code> is called, but a <code>TurboRacecar</code> will return 1100.</p>
</div>
<div class="paragraph">
<p>Even through the <code>TurboRacecar</code> does not have an explicit
<code>getTopSpeed()</code> method, it inherits one from <code>Racecar</code>. Like all derived
classes in Java, <code>TurboRacecar</code> has all the methods and fields that
<code>Racecar</code> does. This relationship is called an <em>is-a</em> relationship
because every <code>TurboRacecar</code> is a <code>Racecar</code> in the sense that you can
use a <code>TurboRacecar</code> whenever a <code>Racecar</code> is required.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dynamic_binding">17.2.2. Dynamic binding</h4>
<div class="paragraph">
<p>There is a little bit of magic that makes polymorphism work. When you
compile your code, the <code>RaceTrack</code> doesn’t know which <code>getHorsePower()</code>
method will eventually get called. Only at run time does it query the
object in question and, if it is a <code>TurboRacecar</code>, use the overridden
method that returns 1100. This feature of Java is called <em>dynamic
binding</em>. Not every object oriented programming language supports
dynamic binding. C++ actually allows the programmer to specify whether
or not a method is dynamically bound.</p>
</div>
<div class="paragraph">
<p>Only methods are dynamically bound in Java. Fields are <em>statically
bound</em>. Consider the following re-definitions of <code>Racecar</code> and
<code>TurboRacecar</code>.</p>
</div>
<div id="StaticRacecarProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">StaticRacecar</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">double</span> <span class="tok-n">TOP_SPEED</span> <span class="tok-o">=</span> <span class="tok-mf">200.0</span><span class="tok-o">;</span>
<span class="lineno">3 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">int</span> <span class="tok-n">HORSEPOWER</span> <span class="tok-o">=</span> <span class="tok-mi">700</span><span class="tok-o">;</span>
<span class="lineno">4 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-n">speed</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span>
<span class="lineno">5 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div id="StaticTurboRacecarProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">StaticTurboRacecar</span> <span class="tok-kd">extends</span> <span class="tok-n">StaticRacecar</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">int</span> <span class="tok-n">HORSEPOWER</span> <span class="tok-o">=</span> <span class="tok-mi">1100</span><span class="tok-o">;</span>
<span class="lineno">3 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Assume that <code>RaceTrack</code> contains a method which prints out the
horsepower of a <code>StaticRacecar</code> like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">printHorsepower</span><span class="tok-o">(</span> <span class="tok-n">StaticRacecar</span> <span class="tok-n">car</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">print</span><span class="tok-o">(</span> <span class="tok-n">car</span><span class="tok-o">.</span><span class="tok-na">HORSEPOWER</span> <span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Even if you pass an object of type <code>StaticTurboRacecar</code>, the value 700
will be printed out every time. In Java, all fields, whether normal,
<code>static</code>, or <code>final</code> are statically bound.</p>
</div>
</div>
<div class="sect3">
<h4 id="_general_vs_specific">17.2.3. General vs. specific</h4>
<div class="paragraph">
<p>Another way to look at inheritance is as a statement of a specialization
and generalization. A <code>TurboRacecar</code> is a specific kind of <code>Racecar</code>
while a <code>Racecar</code> is a general category that <code>TurboRacecar</code> belongs to.</p>
</div>
<div class="paragraph">
<p>The rules of Java say that you can always use a more specific version of
a class than you need but never a more general one. You can use a
<code>TurboRacecar</code> any time you need a <code>Racecar</code> but not the reverse. A
square will do the job of a rectangle, but a rectangle will not always
be suitable when a square is needed.</p>
</div>
<div class="paragraph">
<p>Consider the following two classes:</p>
</div>
<div id="VehicleProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Vehicle</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">travel</span><span class="tok-o">(</span> <span class="tok-n">String</span> <span class="tok-n">destination</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno">3 </span>        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Traveling to &quot;</span> <span class="tok-o">+</span> <span class="tok-n">destination</span> <span class="tok-o">+</span> <span class="tok-s">&quot;!&quot;</span><span class="tok-o">);</span>
<span class="lineno">4 </span>    <span class="tok-o">}</span>
<span class="lineno">5 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div id="RocketShipProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">RocketShip</span> <span class="tok-kd">extends</span> <span class="tok-n">Vehicle</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">blastOff</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno">3 </span>        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;FOOOOM!&quot;</span><span class="tok-o">);</span>
<span class="lineno">4 </span>    <span class="tok-o">}</span>
<span class="lineno">5 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is a method that requires a <code>RocketShip</code> but only uses its
<code>travel()</code> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">takeVacation</span><span class="tok-o">(</span> <span class="tok-n">RocketShip</span> <span class="tok-n">ship</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">destination</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">ship</span><span class="tok-o">.</span><span class="tok-na">travel</span><span class="tok-o">(</span> <span class="tok-n">destination</span> <span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It seems as though we should be able to pass any <code>Vehicle</code> to the
<code>takeVacation()</code> method because the only method in <code>ship</code> used by
<code>takeVacation()</code> is the <code>travel()</code> method. However, the programmer
specified that the parameter should be a <code>RocketShip</code>, and Java plays it
safe. Just because it looks like there won’t be a problem, Java isn’t
going to take any chances on passing an overly general <code>Vehicle</code> when a
<code>RocketShip</code> is required. If Java took chances, a problem could arise if
the <code>takeVacation()</code> method was overridden by a method that did call
<code>ship.blastOff()</code>.</p>
</div>
<div class="paragraph">
<p>In summary, you can pass a <code>RocketShip</code> to a method which takes a
<code>Vehicle</code> or store a <code>RocketShip</code> in an array of <code>Vehicles</code>, but not the
reverse. Java usually gives a compile time error if you try to put
something too general into a location that is too specific. There are,
however, some situations which are so tricky that Java doesn’t catch the
error until runtime. Arrays, specifically, can cause problems. Examine
the following code snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Vehicle</span><span class="tok-o">[]</span> <span class="tok-n">transportation</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">RocketShip</span><span class="tok-o">[</span><span class="tok-mi">100</span><span class="tok-o">];</span>
<span class="tok-n">transportation</span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Vehicle</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On the first line, we are using a <code>Vehicle</code> array reference to store an
array of 100 <code>RocketShip`s. But, in the second line, we try to store a
`Vehicle</code> into an array that is really a <code>RocketShip</code> array, even though
it looks to the compiler like a <code>Vehicle</code> array. Doing so will compile
but throw an <code>ArrayStoreException</code> at runtime.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_inheritance_tools_in_java">17.3. Syntax: Inheritance tools in Java</h3>
<div class="paragraph">
<p>So far, we have described polymorphism in Java with a conceptual focus.
In our previous examples, the only language tool needed to use
polymorphism was the <code>extends</code> keyword which you are well familiar with
by now. There are a number of other tools designed to help you structure
class hierarchies and enforce design decisions.</p>
</div>
<div class="sect3">
<h4 id="_abstract_classes_and_methods">17.3.1. Abstract classes and methods</h4>
<div class="paragraph">
<p>One such tool is abstract classes. An abstract class is one which can
never be instantiated. In order to use an abstract class, it is
necessary to derive a class from it. To create an abstract class, you
just need to add the <code>abstract</code> keyword to its definition, as in the
following example.</p>
</div>
<div id="UselessProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kd">class</span> <span class="tok-nc">Useless</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">protected</span> <span class="tok-kt">int</span> <span class="tok-n">variable</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span>    <span class="tok-kd">public</span> <span class="tok-nf">Useless</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">input</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 5 </span>        <span class="tok-n">variable</span> <span class="tok-o">=</span> <span class="tok-n">input</span><span class="tok-o">;</span>
<span class="lineno"> 6 </span>    <span class="tok-o">}</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">print</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 9 </span>        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span> <span class="tok-n">variable</span> <span class="tok-o">);</span>
<span class="lineno">10 </span>    <span class="tok-o">}</span>
<span class="lineno">11 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This class is useless for a number of reasons. For one thing, there’s no
way to find out the value of <code>variable</code> except by printing it out.
Furthermore, there’s no way to change the value of <code>variable</code> after the
object has been created. Finally, since an abstract class cannot be
instantiated, the following code snippet will not compile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Useless</span> <span class="tok-n">thing</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Useless</span><span class="tok-o">(</span> <span class="tok-mi">14</span> <span class="tok-o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead, we must create a new class that extends <code>Useless</code>.</p>
</div>
<div id="UsefulProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Useful</span> <span class="tok-kd">extends</span> <span class="tok-n">Useless</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">int</span> <span class="tok-nf">getVariable</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">variable</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">3 </span>
<span class="lineno">4 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setVariable</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">value</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno">5 </span>        <span class="tok-n">variable</span> <span class="tok-o">=</span> <span class="tok-n">value</span><span class="tok-o">;</span>
<span class="lineno">6 </span>    <span class="tok-o">}</span>
<span class="lineno">7 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, we can instantiate an object of type <code>Useful</code> and use it for
something.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Useless</span> <span class="tok-n">item</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Useful</span><span class="tok-o">(</span> <span class="tok-mi">14</span> <span class="tok-o">);</span>
<span class="tok-n">item</span><span class="tok-o">.</span><span class="tok-na">print</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that, in accordance with the rules of Java, we can store a more
specific object of type <code>Useful</code> into more general reference of type
<code>Useless</code>. Even though Java knows that the object it points to will
never actually be a <code>Useless</code> object, it is perfectly legal to have a
<code>Useless</code> reference. You can use abstract classes in this way to provide
a base class with some fundamental fields and methods that all other
classes in a particular hierarchy need. By using the keyword <code>abstract</code>,
you are marking the class as template for other classes instead of a
class that will be used directly.</p>
</div>
<div class="paragraph">
<p>Methods can be abstract as well. If you have an abstract class, you can
create a method header which describes a method that all non-abstract
children classes must implement, as show below.</p>
</div>
<div id="SequenceProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kd">class</span> <span class="tok-nc">Sequence</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">protected</span> <span class="tok-kt">int</span> <span class="tok-n">number</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>    <span class="tok-kd">protected</span> <span class="tok-kd">final</span> <span class="tok-kt">int</span> <span class="tok-n">CONSTANT</span><span class="tok-o">;</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span>    <span class="tok-kd">public</span> <span class="tok-nf">Sequence</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">number</span><span class="tok-o">,</span> <span class="tok-kt">int</span> <span class="tok-n">constant</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 6 </span>        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">number</span> <span class="tok-o">=</span> <span class="tok-n">number</span><span class="tok-o">;</span>
<span class="lineno"> 7 </span>        <span class="tok-n">CONSTANT</span> <span class="tok-o">=</span> <span class="tok-n">constant</span><span class="tok-o">;</span>
<span class="lineno"> 8 </span>    <span class="tok-o">}</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span>    <span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kt">int</span> <span class="tok-nf">getNextValue</span><span class="tok-o">();</span>
<span class="lineno">11 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This abstract class is supposed to be a template for classes which can
produce some sequence of numbers. Note that there is no body for the
<code>getNextValue()</code> method. It simply ends with a semicolon. Every
non-abstract derived class must implement a <code>getNextValue()</code> method to
produce the next number in the sequence. For example, we could implement
an arithmetic or a geometric sequence as follows.</p>
</div>
<div id="ArithmeticSequenceProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ArithmeticSequence</span> <span class="tok-kd">extends</span> <span class="tok-n">Sequence</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kt">int</span> <span class="tok-nf">getNextValue</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno">3 </span>        <span class="tok-n">number</span> <span class="tok-o">+=</span> <span class="tok-n">CONSTANT</span><span class="tok-o">;</span>
<span class="lineno">4 </span>        <span class="tok-k">return</span> <span class="tok-n">number</span><span class="tok-o">;</span>
<span class="lineno">5 </span>    <span class="tok-o">}</span>
<span class="lineno">6 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div id="GeometricSequenceProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">GeometricSequence</span> <span class="tok-kd">extends</span> <span class="tok-n">Sequence</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kt">int</span> <span class="tok-nf">getNextValue</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno">3 </span>        <span class="tok-n">number</span> <span class="tok-o">*=</span> <span class="tok-n">CONSTANT</span><span class="tok-o">;</span>
<span class="lineno">4 </span>        <span class="tok-k">return</span> <span class="tok-n">number</span><span class="tok-o">;</span>
<span class="lineno">5 </span>    <span class="tok-o">}</span>
<span class="lineno">6 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Sequence</code> class does not specify <strong>how</strong> the sequence of numbers
should be generated, but any derived class must implement the
<code>getNextValue()</code> method in order to compile. By using an abstract class,
we don’t have to create a base class which generates a meaningless
sequence of numbers just for the sake of establishing the
<code>getNextValue()</code> method.</p>
</div>
<div class="paragraph">
<p>Here’s a more involved example of an abstract class that gives a first
step toward solving the bank account with a vengeance problem posed at
the beginning of the chapter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kn">import</span> <span class="tok-nn">java.util.Calendar</span><span class="tok-o">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first step is to import the <code>Calendar</code> class for some date stuff we
are going to use later.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno">1 </span><span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kd">class</span> <span class="tok-nc">BankAccount</span> <span class="tok-kd">extends</span> <span class="tok-n">SynchronizedAccount</span> <span class="tok-o">{</span>
<span class="lineno">2 </span>    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">;</span>
<span class="lineno">3 </span>    <span class="tok-kd">private</span> <span class="tok-n">Calendar</span> <span class="tok-n">lastAccess</span><span class="tok-o">;</span>
<span class="lineno">4 </span>    <span class="tok-kd">private</span> <span class="tok-kt">int</span> <span class="tok-n">monthsPassed</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We extend <code>SynchronizedAccount</code> and declare the new class to be
abstract. In this example, we do not use any abstract methods, but,
since each bank account has unique characteristics, we don’t want people
to be able to create a generic <code>BankAccount</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span>    <span class="tok-kd">public</span> <span class="tok-nf">BankAccount</span><span class="tok-o">(</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-kt">double</span> <span class="tok-n">balance</span> <span class="tok-o">)</span>
<span class="lineno"> 2 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 3 </span>        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">name</span> <span class="tok-o">=</span> <span class="tok-n">name</span><span class="tok-o">;</span>
<span class="lineno"> 4 </span>        <span class="tok-n">changeBalance</span><span class="tok-o">(</span> <span class="tok-n">balance</span> <span class="tok-o">);</span>
<span class="lineno"> 5 </span>        <span class="tok-n">lastAccess</span> <span class="tok-o">=</span> <span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">getInstance</span><span class="tok-o">();</span>
<span class="lineno"> 6 </span>    <span class="tok-o">}</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span>    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getName</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">name</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span>    <span class="tok-kd">protected</span> <span class="tok-n">Calendar</span> <span class="tok-nf">getLastAccess</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">lastAccess</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span>    <span class="tok-kd">protected</span> <span class="tok-kt">int</span> <span class="tok-nf">getMonthsPassed</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">monthsPassed</span><span class="tok-o">;</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The constructor and the accessors should be what you expect to see. Note
that calling the static method <code>Calendar.getInstance()</code> is the correct
way to get a <code>Calendar</code> object with the current date and time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span>    <span class="tok-kd">public</span> <span class="tok-kd">final</span> <span class="tok-kt">double</span> <span class="tok-nf">getBalance</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>        <span class="tok-n">update</span><span class="tok-o">();</span>
<span class="lineno"> 3 </span>        <span class="tok-k">return</span> <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">getBalance</span><span class="tok-o">();</span>
<span class="lineno"> 4 </span>    <span class="tok-o">}</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-kd">final</span> <span class="tok-kt">void</span> <span class="tok-nf">deposit</span><span class="tok-o">(</span> <span class="tok-kt">double</span> <span class="tok-n">amount</span> <span class="tok-o">)</span>
<span class="lineno"> 7 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 8 </span>        <span class="tok-n">update</span><span class="tok-o">();</span>
<span class="lineno"> 9 </span>        <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">deposit</span><span class="tok-o">(</span> <span class="tok-n">amount</span> <span class="tok-o">);</span>
<span class="lineno">10 </span>    <span class="tok-o">}</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span>    <span class="tok-kd">public</span> <span class="tok-kd">final</span> <span class="tok-kt">boolean</span> <span class="tok-nf">withdraw</span><span class="tok-o">(</span> <span class="tok-kt">double</span> <span class="tok-n">amount</span> <span class="tok-o">)</span>
<span class="lineno">13 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno">14 </span>        <span class="tok-n">update</span><span class="tok-o">();</span>
<span class="lineno">15 </span>        <span class="tok-k">return</span> <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">withdraw</span><span class="tok-o">(</span><span class="tok-n">amount</span><span class="tok-o">);</span>
<span class="lineno">16 </span>    <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then come the balance checking and changing methods. Each simply calls
the parent methods after calling an <code>update()</code> method we discuss below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span>    <span class="tok-kd">protected</span> <span class="tok-kd">synchronized</span> <span class="tok-kt">void</span> <span class="tok-nf">update</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>        <span class="tok-n">Calendar</span> <span class="tok-n">current</span> <span class="tok-o">=</span> <span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">getInstance</span><span class="tok-o">();</span>
<span class="lineno"> 3 </span>        <span class="tok-kt">int</span> <span class="tok-n">months</span> <span class="tok-o">=</span> <span class="tok-mi">12</span><span class="tok-o">*(</span><span class="tok-n">current</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">YEAR</span><span class="tok-o">)</span> <span class="tok-o">-</span>
<span class="lineno"> 4 </span>        <span class="tok-n">getLastAccess</span><span class="tok-o">().</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">YEAR</span><span class="tok-o">))</span> <span class="tok-o">+</span>
<span class="lineno"> 5 </span>        <span class="tok-o">(</span><span class="tok-n">current</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">MONTH</span><span class="tok-o">)</span> <span class="tok-o">-</span>
<span class="lineno"> 6 </span>        <span class="tok-n">getLastAccess</span><span class="tok-o">().</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">MONTH</span><span class="tok-o">));</span>
<span class="lineno"> 7 </span>        <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">months</span> <span class="tok-o">&gt;</span> <span class="tok-mi">0</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 8 </span>                <span class="tok-n">lastAccess</span> <span class="tok-o">=</span> <span class="tok-n">current</span><span class="tok-o">;</span>
<span class="lineno"> 9 </span>                <span class="tok-n">monthsPassed</span> <span class="tok-o">=</span> <span class="tok-n">months</span><span class="tok-o">;</span>
<span class="lineno">10 </span>        <span class="tok-o">}</span>
<span class="lineno">11 </span>    <span class="tok-o">}</span>
<span class="lineno">12 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Other than adding <code>String</code> for a name associated with the account, the
<code>update()</code> method is the other major addition made in <code>BankAccount</code>.
Each time <code>update()</code> is called, the number of months since the last
access is stored in the field <code>monthsPast</code> and the timestamp of the last
access is stored in <code>lastAccess</code>. We didn’t need these time features
before, but issues like earning interest or paying monthly service
charges will make them necessary. This method is synchronized so that
the two fields associated with the last access are updated atomically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_final_classes_and_methods">17.3.2. Final classes and methods</h4>
<div class="paragraph">
<p>If you look at the previous example carefully, you will notice that the
methods <code>getBalance()</code>, <code>deposit()</code>, and <code>withdraw()</code> were each declared
with the keyword <code>final</code>. You have seen this keyword used to declare
constants before. When applied to methods, <code>final</code> is philosophically
similar (and almost the opposite of <code>abstract</code>). A method which is
declared <code>final</code> cannot be overridden by child classes. If you are
designing a class hierarchy and you want to lock a method into doing a
specific thing and never changing, this is the way to do it.</p>
</div>
<div class="paragraph">
<p>Like <code>abstract</code>, the keyword <code>final</code> can be applied to a class as well.
If you want to prevent a class from being extended further, apply the
<code>final</code> keyword to its definition. You may not find yourself using this
feature of Java very often. It is primarily useful in situations where a
large body of code has been designed to make use of a specific class.
The designers of that specific class want to keep it exactly the way it
is and prevent anything unexpected from happening.</p>
</div>
<div class="paragraph">
<p>The most common example of a <code>final</code> class is the <code>String</code> class.
Consider the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SuperString</span> <span class="tok-kd">extends</span> <span class="tok-n">String</span> <span class="tok-o">{}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This code will give a compiler error. <code>String</code> is perfect the way it is
(or so the Java designers have decided). There is no reason to restrict
your code arbitrarily, but use of the <code>final</code> keyword for classes,
methods, and especially to specify constants allows the compiler to do
some performance optimizations that would otherwise be impossible.</p>
</div>
</div>
<div class="sect3">
<h4 id="_casting">17.3.3. Casting</h4>
<div class="paragraph">
<p>If we shift the focus back to polymorphism, we have to admit that we
have avoided one of the messier issues. It’s true that polymorphism
gives us lots of power. For example, we can make a <code>Vehicle</code> array and
store subclasses of <code>Vehicle</code> inside, like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Vehicle</span><span class="tok-o">[]</span> <span class="tok-n">vehicles</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Vehicle</span><span class="tok-o">[</span><span class="tok-mi">5</span><span class="tok-o">];</span>
<span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Skateboard</span><span class="tok-o">();</span>
<span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">RocketShip</span><span class="tok-o">();</span>
<span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">2</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">SteamBoat</span><span class="tok-o">();</span>
<span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">3</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Car</span><span class="tok-o">();</span>
<span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">4</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Skateboard</span><span class="tok-o">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This process could be infinitely more complex. We could be reading data
out of a file and dynamically creating different kinds of <code>Vehicle</code>
objects. But, the final product of an array of <code>Vehicle</code> objects is the
important thing. Now, we can run through the array with a loop and have
the code magically work for each kind of <code>Vehicle</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-k">for</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">vehicles</span><span class="tok-o">.</span><span class="tok-na">length</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">++</span> <span class="tok-o">)</span>
    <span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-n">i</span><span class="tok-o">].</span><span class="tok-na">travel</span><span class="tok-o">(</span> <span class="tok-s">&quot;Prague&quot;</span> <span class="tok-o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Each <code>Vehicle</code> will travel to Prague as it should. The only trouble is
that we have hidden some information. We know that <code>vehicles[1]</code> is a
<code>RocketShip</code>, but we can’t treat it like one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">].</span><span class="tok-na">blastOff</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This code will not compile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">RocketShip</span> <span class="tok-n">ship</span> <span class="tok-o">=</span> <span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">];</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This code will not compile either. In both cases, we must use an
explicit cast to tell the compiler that the object really <strong>is</strong> a
<code>RocketShip</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">RocketShip</span> <span class="tok-n">ship</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">RocketShip</span><span class="tok-o">)</span><span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">];</span>
<span class="tok-o">((</span><span class="tok-n">RocketShip</span><span class="tok-o">)</span><span class="tok-n">vehicles</span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">]).</span><span class="tok-na">blastOff</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both lines of code will work. The compiler is always conservative. It
never makes guesses about the type of something. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Vehicle</span> <span class="tok-n">ship</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">RocketShip</span><span class="tok-o">();</span>
<span class="tok-n">ship</span><span class="tok-o">.</span><span class="tok-na">blastOff</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Even though <code>ship</code> <strong>must</strong> be a <code>RocketShip</code>, Java does not assume that.
The compiler uses the reference type <code>Vehicle</code> to do the check and will
refuse to compile. Casting allows us to use our human intellect to
overcome the shortsightedness of the compiler. Human intellect is
unfortunately flawed. What happens if you cast improperly?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Vehicle</span> <span class="tok-n">vehicle</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Skateboard</span><span class="tok-o">();</span>
<span class="tok-n">RocketShip</span> <span class="tok-n">ship</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">RocketShip</span><span class="tok-o">)</span><span class="tok-n">vehicle</span><span class="tok-o">;</span>
<span class="tok-n">ship</span><span class="tok-o">.</span><span class="tok-na">blastOff</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we are trying to cast a <code>Skateboard</code> into a
<code>RocketShip</code>. At compile time, no errors will be found. Because we use
explicit casting, the compiler assumes that we, powerful human beings
that we are, know what we are doing. The error will happen at runtime
while executing the second line. Java will try to cast <code>vehicle</code> into a
<code>RocketShip</code>, fail, and throw a <code>ClassCastException</code>.</p>
</div>
<div class="paragraph">
<p>Java provides some additional tools to make casting easier. One of these
is the <code>instanceof</code> keyword which can be used to test if an object is an
instance of a particular class (or one of its derived classes). For
example, we can make an object execute a special command if we know that
the object is capable of it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">visitDenver</span><span class="tok-o">(</span> <span class="tok-n">Vehicle</span> <span class="tok-n">vehicle</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">vehicle</span> <span class="tok-k">instanceof</span> <span class="tok-n">RocketShip</span> <span class="tok-o">)</span>
        <span class="tok-o">((</span><span class="tok-n">RocketShip</span><span class="tok-o">)</span><span class="tok-n">vehicle</span><span class="tok-o">).</span><span class="tok-na">blastOff</span><span class="tok-o">();</span>
    <span class="tok-n">vehicle</span><span class="tok-o">.</span><span class="tok-na">travel</span><span class="tok-o">(</span> <span class="tok-s">&quot;Denver&quot;</span> <span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Even inside the <code>if</code> statement where it must be the case that <code>vehicle</code>
is a <code>RocketShip</code>, we still must perform an explicit cast. Sometimes
<code>instanceof</code> is not precise enough. If you must be sure that the object
in question is a specific class and not just one of its subclasses, you
can use the <code>getClass()</code> method on any object and compare it to the
static class object. Using this tool, we can rewrite the former example
to be more specific.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">visitDenver</span><span class="tok-o">(</span> <span class="tok-n">Vehicle</span> <span class="tok-n">vehicle</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">vehicle</span><span class="tok-o">.</span><span class="tok-na">getClass</span><span class="tok-o">()</span> <span class="tok-o">==</span>  <span class="tok-n">RocketShip</span><span class="tok-o">.</span><span class="tok-na">class</span> <span class="tok-o">)</span>
        <span class="tok-o">((</span><span class="tok-n">RocketShip</span><span class="tok-o">)</span><span class="tok-n">vehicle</span><span class="tok-o">).</span><span class="tok-na">blastOff</span><span class="tok-o">();</span>
    <span class="tok-n">vehicle</span><span class="tok-o">.</span><span class="tok-na">travel</span><span class="tok-o">(</span> <span class="tok-s">&quot;Denver&quot;</span> <span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This version of the code will only call <code>blastOff()</code> for objects of
class <code>RocketShip</code> and not for objects of a subclass like
<code>FusionPoweredRocketShip</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_inheritance_and_exceptions">17.3.4. Inheritance and exceptions</h4>
<div class="paragraph">
<p>Beyond `ClassCastException`s, there are a few other issues that come up
when combining exceptions with inheritance. As you already know, an
exception handler for a parent class will work for a child class. As
such, when using multiple exception handlers, it is necessary to order
them from most specific to most general in terms of class hierarchy.</p>
</div>
<div class="paragraph">
<p>However, there is another subtle rule that is necessary to keep
polymorphism functioning smoothly. Let’s consider a <code>Fruit</code> class with
an <code>eat()</code> method that throws an <code>UnripeFruitException</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Fruit</span> <span class="tok-o">{</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">eat</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">UnripeFruitException</span> <span class="tok-o">{</span>
        <span class="tok-o">...</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Almost any fruit can be unripe, and it is unpleasant to try to eat an
unripe fruit. But, there are other things that can go wrong when eating
fruit. Consider the <code>Plum</code> class derived from <code>Fruit</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Plum</span> <span class="tok-kd">extends</span> <span class="tok-n">Fruit</span> <span class="tok-o">{</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">eat</span><span class="tok-o">()</span> <span class="tok-kd">throws</span>
        <span class="tok-n">UnripeFruitException</span><span class="tok-o">,</span> <span class="tok-n">ChokingOnPitException</span> <span class="tok-o">{</span>
        <span class="tok-o">...</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>Plum</code> class, the <code>eat()</code> method has been overridden to tackle
the special ways that eating a plum is different from eating fruit in
general. When eating a plum, you can make a mistake and try to swallow
the pit, throwing, it seems, a <code>ChokingOnPitException</code>. This scenario
seems natural, but it is not allowed in Java.</p>
</div>
<div class="paragraph">
<p>The principle behind polymorphism is that a more specialized version of
something can be used in place of a more general version. Indeed, if you
use a <code>Plum</code> in place of a <code>Fruit</code>, calling the <code>eat()</code> method is no
problem. The problem happens if a <code>ChokingOnPitException</code> is thrown.
Now, code which was designed for <code>Fruit</code> objects knows nothing about a
<code>ChokingOnPitException</code>, so there is no way for such code to catch the
exception and deal with the situation.</p>
</div>
<div class="paragraph">
<p>There is nothing wrong with throwing exceptions on overridden methods.
The rule is that the overriding method must throw a subset (not a proper
subset, so it could be all of the original exceptions) of the exceptions
that the overridden method throws. This rule is actually a concept
called Hoare’s rule of consequence that pops up several places in
programming languages. Essentially, if you start with something that
works, tighten the requirements on the input (use a <code>Plum</code> instead of
any <code>Fruit</code>), loosen the requirements on the output (throw fewer
exceptions than were originally thrown), it will still work.</p>
</div>
<div class="exampleblock">
<div class="title">Example 142. More human than human</div>
<div class="content">
<div class="paragraph">
<p>Now we have a few additional examples in a somewhat larger class
hierarchy.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="chapters/17-polymorphism/images/animals.svg" alt="animals" width="75%">
</div>
<div class="title">Figure 71. Animal class hierarchy.</div>
</div>
<div id="AnimalProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kd">class</span> <span class="tok-nc">Animal</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">private</span> <span class="tok-kt">boolean</span> <span class="tok-n">alive</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>    <span class="tok-kd">private</span> <span class="tok-kt">boolean</span> <span class="tok-n">happy</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">;</span>
<span class="lineno"> 4 </span>    <span class="tok-kd">private</span> <span class="tok-kd">final</span> <span class="tok-kt">boolean</span> <span class="tok-n">warmblooded</span><span class="tok-o">;</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-nf">Animal</span><span class="tok-o">(</span> <span class="tok-kt">boolean</span> <span class="tok-n">warmblooded</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 7 </span>        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">warmblooded</span> <span class="tok-o">=</span> <span class="tok-n">warmblooded</span><span class="tok-o">;</span>
<span class="lineno"> 8 </span>    <span class="tok-o">}</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span>    <span class="tok-kd">public</span> <span class="tok-kt">boolean</span> <span class="tok-nf">isHappy</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">happy</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setHappy</span><span class="tok-o">(</span> <span class="tok-kt">boolean</span> <span class="tok-n">value</span> <span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">happy</span> <span class="tok-o">=</span> <span class="tok-n">value</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">13 </span>
<span class="lineno">14 </span>    <span class="tok-kd">public</span> <span class="tok-kt">boolean</span> <span class="tok-nf">isAlive</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">alive</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">15 </span>
<span class="lineno">16 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">die</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-n">alive</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">17 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We begin with the abstract <code>Animal</code> class. This class gives a base
definition for animals which includes whether the animal is alive,
whether the animal is happy, and whether it is warmblooded (declared
<code>final</code> because an animal can’t switch between warmblooded and
coldblooded).</p>
</div>
<div id="MammalProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-kd">class</span> <span class="tok-nc">Mammal</span> <span class="tok-kd">extends</span> <span class="tok-n">Animal</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">boolean</span> <span class="tok-n">MALE</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">boolean</span> <span class="tok-n">FEMALE</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">;</span>
<span class="lineno"> 4 </span>    <span class="tok-kd">private</span> <span class="tok-kd">final</span> <span class="tok-kt">boolean</span> <span class="tok-n">gender</span><span class="tok-o">;</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-nf">Mammal</span><span class="tok-o">(</span> <span class="tok-kt">boolean</span> <span class="tok-n">gender</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 7 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-kc">true</span> <span class="tok-o">);</span>
<span class="lineno"> 8 </span>        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">gender</span> <span class="tok-o">=</span> <span class="tok-n">gender</span><span class="tok-o">;</span>
<span class="lineno"> 9 </span>    <span class="tok-o">}</span>
<span class="lineno">10 </span>
<span class="lineno">11 </span>    <span class="tok-kd">public</span> <span class="tok-nf">getGender</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">gender</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">12 </span>
<span class="lineno">13 </span>    <span class="tok-kd">public</span> <span class="tok-kd">abstract</span> <span class="tok-n">String</span> <span class="tok-nf">makeSound</span><span class="tok-o">();</span>
<span class="lineno">14 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We then extend <code>Animal</code> into <code>Mammal</code>. All mammals are warmblooded,
which is reflected in the constructor call to the base class. In
addition, it is assumed that all mammals make some sound. Mammals also
have well-defined genders, declared <code>final</code> because it cannot change
once it has been set. Like <code>Animal</code>, <code>Mammal</code> is an abstract class, and
any non-abstract subclass of <code>Mammal</code> must implement <code>makeSound()</code>.</p>
</div>
<div id="PlatypusProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Platypus</span> <span class="tok-kd">extends</span> <span class="tok-n">Mammal</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-nf">Platypus</span><span class="tok-o">(</span> <span class="tok-kt">boolean</span> <span class="tok-n">gender</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 3 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-n">gender</span> <span class="tok-o">);</span>
<span class="lineno"> 4 </span>    <span class="tok-o">}</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">makeSound</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 7 </span>        <span class="tok-k">return</span> <span class="tok-s">&quot;Quack!&quot;</span>
<span class="lineno"> 8 </span>    <span class="tok-o">}</span>
<span class="lineno"> 9 </span>
<span class="lineno">10 </span>    <span class="tok-kd">public</span> <span class="tok-n">Egg</span> <span class="tok-nf">layEgg</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno">11 </span>        <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">getGender</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-n">FEMALE</span> <span class="tok-o">)</span>
<span class="lineno">12 </span>            <span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-n">Egg</span><span class="tok-o">();</span>
<span class="lineno">13 </span>        <span class="tok-k">else</span>
<span class="lineno">14 </span>            <span class="tok-k">return</span> <span class="tok-kc">null</span><span class="tok-o">;</span>
<span class="lineno">15 </span>    <span class="tok-o">}</span>
<span class="lineno">16 </span>
<span class="lineno">17 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">poison</span><span class="tok-o">(</span> <span class="tok-n">Animal</span> <span class="tok-n">victim</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno">18 </span>        <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">getGender</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-n">MALE</span> <span class="tok-o">)</span>
<span class="lineno">19 </span>            <span class="tok-n">victim</span><span class="tok-o">.</span><span class="tok-na">setHappy</span><span class="tok-o">(</span> <span class="tok-kc">false</span> <span class="tok-o">);</span>
<span class="lineno">20 </span>    <span class="tok-o">}</span>
<span class="lineno">21 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Platypus</code> class extends <code>Mammal</code> and adds the unusual things that a
platypus can do: laying eggs (if female) and poisoning other animals (if
male).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Human</span> <span class="tok-kd">extends</span> <span class="tok-n">Mammal</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-nf">Human</span><span class="tok-o">(</span> <span class="tok-kt">boolean</span> <span class="tok-n">gender</span><span class="tok-o">,</span> <span class="tok-kt">boolean</span> <span class="tok-n">happy</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 3 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-n">gender</span> <span class="tok-o">);</span>
<span class="lineno"> 4 </span>        <span class="tok-n">setHappy</span><span class="tok-o">(</span> <span class="tok-n">happy</span> <span class="tok-o">);</span>
<span class="lineno"> 5 </span>    <span class="tok-o">}</span>
<span class="lineno"> 6 </span>
<span class="lineno"> 7 </span>    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">makeSound</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 8 </span>        <span class="tok-k">return</span> <span class="tok-s">&quot;Hello, world.&quot;</span>
<span class="lineno"> 9 </span>    <span class="tok-o">}</span>
<span class="lineno">10 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Human</code> class also extends <code>Mammal</code>. Depending on the problem being
solved, this class might warrant a great deal more specialization. Right
now the main addition is taking happiness as an argument to the
constructor. Unfortunately, the default human state is not necessarily
happiness.</p>
</div>
<div id="DavidBowieProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">final</span> <span class="tok-kd">class</span> <span class="tok-nc">DavidBowie</span> <span class="tok-kd">extends</span> <span class="tok-n">Human</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-nf">DavidBowie</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 3 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-n">MALE</span><span class="tok-o">,</span> <span class="tok-kc">true</span> <span class="tok-o">);</span>
<span class="lineno"> 4 </span>    <span class="tok-o">}</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">makeSound</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 7 </span>        <span class="tok-k">return</span> <span class="tok-s">&quot;I always had a repulsive need to be &quot;</span> <span class="tok-o">+</span>
<span class="lineno"> 8 </span>        <span class="tok-s">&quot;something more than human.&quot;</span>
<span class="lineno"> 9 </span>    <span class="tok-o">}</span>
<span class="lineno">10 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, the <code>DavidBowie</code> class extends <code>Human</code> and is declared a final
class because it really is impossible to add anything to David Bowie.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>You will notice that our examples have stretched fairly long in this
chapter. It is difficult to give strong motivation for some aspects of
inheritance and polymorphism without a large class hierarchy. These
tools are designed to help organize large bodies of code and should
become more useful as the size of the problem you are working on grows.
One of the best examples of the success of inheritance is the Java API
itself. The standard Java library is very large and depends on
inheritance a great deal.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_solution_banking_account_with_a_vengeance">17.4. Solution: Banking account with a vengeance</h3>
<div class="paragraph">
<p>Now we return to the specific problem given at the beginning of the
chapter and give its solution. We have already given you the
<code>BankAccount</code> abstract class which provides a lot of structure.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="chapters/17-polymorphism/images/accounts.svg" alt="accounts" width="75%">
</div>
<div class="title">Figure 72. Bank account class hierarchy.</div>
</div>
<div id="CheckingAccountProgram" class="listingblock">
<div class="title">Program 75. Subclass of <code>BankAccount</code> that models a normal checking account.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CheckingAccount</span> <span class="tok-kd">extends</span> <span class="tok-n">BankAccount</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">double</span> <span class="tok-n">FEE</span> <span class="tok-o">=</span> <span class="tok-mi">10</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span>    <span class="tok-kd">public</span> <span class="tok-nf">CheckingAccount</span><span class="tok-o">(</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-kt">double</span> <span class="tok-n">balance</span> <span class="tok-o">)</span>
<span class="lineno"> 5 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 6 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-n">balance</span> <span class="tok-o">);</span>
<span class="lineno"> 7 </span>    <span class="tok-o">}</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span>    <span class="tok-kd">protected</span> <span class="tok-kd">synchronized</span> <span class="tok-kt">void</span> <span class="tok-nf">update</span><span class="tok-o">()</span>
<span class="lineno">10 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno">11 </span>        <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">update</span><span class="tok-o">();</span>
<span class="lineno">12 </span>        <span class="tok-n">changeBalance</span><span class="tok-o">(</span> <span class="tok-o">-</span><span class="tok-n">getFee</span><span class="tok-o">()*</span><span class="tok-n">getMonthsPassed</span><span class="tok-o">()</span> <span class="tok-o">);</span>
<span class="lineno">13 </span>    <span class="tok-o">}</span>
<span class="lineno">14 </span>
<span class="lineno">15 </span>    <span class="tok-kd">protected</span> <span class="tok-kt">double</span> <span class="tok-nf">getFee</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">FEE</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">16 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The most basic account is the <code>CheckingAccount</code>. As you recall from the
<code>BankingAccount</code> class, the <code>getBalance()</code>, <code>deposit()</code>, and
<code>withdraw()</code> methods are all declared <code>final</code>. At first it seems as if
there is no way to change these methods to add the $10 service charge.
However, each of those methods calls the <code>update()</code> method first to take
care of any bookkeeping. By overriding the <code>update()</code> method, we can
easily add the service charge. The new <code>update()</code> method calls the
parent <code>update()</code> to calculate the passage of time, then it changes the
balance based on the number of months that have passed.</p>
</div>
<div class="paragraph">
<p>The system we have adopted may seem unusual at first. Any time the
balance is checked, deposited to, or withdrawn from, we call <code>update()</code>.
By updating the account to reflect any months which may have passed
before continuing on, we do not have to write code which periodically
updates each bank account. Each bank account is only updated if needed.</p>
</div>
<div class="paragraph">
<p>We were careful to mark <code>update()</code> as <code>synchronized</code>. Although the
chance of an error happening is small, we make the update of the
internal <code>Calendar</code> and the application of any fee atomic, just to be
safe.</p>
</div>
<div class="paragraph">
<p>Note that we do not use the constant <code>FEE</code> directly in <code>update()</code>.
Instead, we call the <code>getFee()</code> method. The reason for this decision is
due to the next class.</p>
</div>
<div id="DirectDepositAccountProgram" class="listingblock">
<div class="title">Program 76. Subclass of <code>CheckingAccount</code> that models the behavior of accounts with direct deposits.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kn">import</span> <span class="tok-nn">java.util.Calendar</span><span class="tok-o">;</span>
<span class="lineno"> 2 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">DirectDepositAccount</span> <span class="tok-kd">extends</span> <span class="tok-n">CheckingAccount</span> <span class="tok-o">{</span>
<span class="lineno"> 3 </span>    <span class="tok-kd">protected</span> <span class="tok-n">Calendar</span> <span class="tok-n">lastDirectDeposit</span><span class="tok-o">;</span>
<span class="lineno"> 4 </span>
<span class="lineno"> 5 </span>    <span class="tok-kd">public</span> <span class="tok-nf">DirectDepositAccount</span><span class="tok-o">(</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-kt">double</span> <span class="tok-n">balance</span> <span class="tok-o">)</span>
<span class="lineno"> 6 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 7 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-n">balance</span> <span class="tok-o">);</span>
<span class="lineno"> 8 </span>        <span class="tok-n">lastDirectDeposit</span> <span class="tok-o">=</span> <span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">getInstance</span><span class="tok-o">();</span>
<span class="lineno"> 9 </span>    <span class="tok-o">}</span>
<span class="lineno">10 </span>
<span class="lineno">11 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-nf">getFee</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno">12 </span>        <span class="tok-n">Calendar</span> <span class="tok-n">current</span> <span class="tok-o">=</span> <span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">getInstance</span><span class="tok-o">();</span>
<span class="lineno">13 </span>        <span class="tok-kt">int</span> <span class="tok-n">months</span> <span class="tok-o">=</span> <span class="tok-mi">12</span><span class="tok-o">*(</span><span class="tok-n">current</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">YEAR</span><span class="tok-o">)</span> <span class="tok-o">-</span>
<span class="lineno">14 </span>        <span class="tok-n">lastDirectDeposit</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">YEAR</span><span class="tok-o">))</span> <span class="tok-o">+</span>
<span class="lineno">15 </span>        <span class="tok-o">(</span><span class="tok-n">current</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">MONTH</span><span class="tok-o">)</span> <span class="tok-o">-</span>
<span class="lineno">16 </span>        <span class="tok-n">lastDirectDeposit</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">MONTH</span><span class="tok-o">));</span>
<span class="lineno">17 </span>        <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">months</span> <span class="tok-o">&lt;=</span> <span class="tok-mi">1</span> <span class="tok-o">)</span>
<span class="lineno">18 </span>            <span class="tok-k">return</span> <span class="tok-mi">0</span><span class="tok-o">;</span>
<span class="lineno">19 </span>        <span class="tok-k">else</span>
<span class="lineno">20 </span>            <span class="tok-k">return</span> <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">getFee</span><span class="tok-o">();</span>
<span class="lineno">21 </span>    <span class="tok-o">}</span>
<span class="lineno">22 </span>
<span class="lineno">23 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">directDeposit</span><span class="tok-o">(</span> <span class="tok-kt">double</span> <span class="tok-n">amount</span> <span class="tok-o">)</span>
<span class="lineno">24 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno">25 </span>        <span class="tok-n">deposit</span><span class="tok-o">(</span> <span class="tok-n">amount</span> <span class="tok-o">);</span>
<span class="lineno">26 </span>        <span class="tok-n">lastDirectDeposit</span> <span class="tok-o">=</span> <span class="tok-n">Calendar</span><span class="tok-o">.</span><span class="tok-na">getInstance</span><span class="tok-o">();</span>
<span class="lineno">27 </span>    <span class="tok-o">}</span>
<span class="lineno">28 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DirectDepositAccount</code> class extends the <code>CheckingAccount</code> class.
Note that the <code>update()</code> method hasn’t been overridden. We have added
another <code>Calendar</code> object to keep track of the last time a direct
deposit was made. Then, we do override the <code>getFee()</code> method. If there
has been a recent direct deposit, the fee is nothing, otherwise, it
returns the fee from the <code>CheckingAccount</code>. Because of dynamic binding,
the <code>update()</code> method defined in <code>CheckingAccount</code> will call this
overridden <code>getFee()</code> method for <code>DirectDepositAccount</code> objects.</p>
</div>
<div id="SavingsAccountProgram" class="listingblock">
<div class="title">Program 77. Subclass of <code>BankAccount</code> that models the behavior of a savings account.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SavingsAccount</span> <span class="tok-kd">extends</span> <span class="tok-n">BankAccount</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">double</span> <span class="tok-n">MINIMUM</span> <span class="tok-o">=</span> <span class="tok-mi">1000</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">double</span> <span class="tok-n">FEE</span> <span class="tok-o">=</span> <span class="tok-mi">25</span><span class="tok-o">;</span>
<span class="lineno"> 4 </span>    <span class="tok-kd">protected</span> <span class="tok-kd">final</span> <span class="tok-kt">double</span> <span class="tok-n">RATE</span><span class="tok-o">;</span>
<span class="lineno"> 5 </span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-nf">SavingsAccount</span><span class="tok-o">(</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-kt">double</span> <span class="tok-n">balance</span><span class="tok-o">,</span> <span class="tok-kt">double</span> <span class="tok-n">rate</span> <span class="tok-o">)</span>
<span class="lineno"> 7 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno"> 8 </span>        <span class="tok-kd">super</span><span class="tok-o">(</span> <span class="tok-n">name</span><span class="tok-o">,</span> <span class="tok-n">balance</span> <span class="tok-o">);</span>
<span class="lineno"> 9 </span>        <span class="tok-n">RATE</span> <span class="tok-o">=</span> <span class="tok-n">rate</span><span class="tok-o">;</span>
<span class="lineno">10 </span>    <span class="tok-o">}</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span>    <span class="tok-kd">protected</span> <span class="tok-kt">double</span> <span class="tok-nf">getFee</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">FEE</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">13 </span>
<span class="lineno">14 </span>    <span class="tok-kd">protected</span> <span class="tok-kt">double</span> <span class="tok-nf">getMinimum</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">return</span> <span class="tok-n">MINIMUM</span><span class="tok-o">;</span> <span class="tok-o">}</span>
<span class="lineno">15 </span>
<span class="lineno">16 </span>    <span class="tok-kd">protected</span> <span class="tok-kd">synchronized</span> <span class="tok-kt">void</span> <span class="tok-nf">update</span><span class="tok-o">()</span>
<span class="lineno">17 </span>        <span class="tok-kd">throws</span> <span class="tok-n">InterruptedException</span> <span class="tok-o">{</span>
<span class="lineno">18 </span>        <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">update</span><span class="tok-o">();</span>
<span class="lineno">19 </span>        <span class="tok-kt">int</span> <span class="tok-n">months</span> <span class="tok-o">=</span> <span class="tok-n">getMonthsPassed</span><span class="tok-o">();</span>
<span class="lineno">20 </span>        <span class="tok-k">for</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">months</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">++</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno">21 </span>            <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">getBalance</span><span class="tok-o">()</span> <span class="tok-o">&gt;</span> <span class="tok-mi">0</span> <span class="tok-o">)</span>
<span class="lineno">22 </span>                <span class="tok-n">changeBalance</span><span class="tok-o">(</span> <span class="tok-n">getBalance</span><span class="tok-o">()</span> <span class="tok-o">*</span> <span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-o">+</span> <span class="tok-n">RATE</span><span class="tok-o">/</span><span class="tok-mi">12</span><span class="tok-o">)</span> <span class="tok-o">);</span>
<span class="lineno">23 </span>            <span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">getBalance</span><span class="tok-o">()</span> <span class="tok-o">&lt;</span> <span class="tok-n">getMinimum</span><span class="tok-o">()</span> <span class="tok-o">)</span>
<span class="lineno">24 </span>                <span class="tok-n">changeBalance</span><span class="tok-o">(</span> <span class="tok-o">-</span><span class="tok-n">getFee</span><span class="tok-o">()</span> <span class="tok-o">);</span>
<span class="lineno">25 </span>        <span class="tok-o">}</span>
<span class="lineno">26 </span>    <span class="tok-o">}</span>
<span class="lineno">27 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There should be few surprises in the last class, <code>SavingsAccount</code>. The
biggest difference is that, in the <code>update()</code> method, we use a loop to
update the balance because the account could be gaining interest and
also incurring fees. The interaction of the two operations may give a
different result than applying each in a block for the backlog of
months.</p>
</div>
<div class="paragraph">
<p>This set of classes may not resemble the way a real, commercial-grade
banking application works. Nevertheless, with inheritance and
polymorphism we were able to create bank accounts which do some
complicated tasks with a relatively small amount of code. At the same
time, we preserved thread safety so that these accounts can be used in
concurrent environments.</p>
</div>
</div>
<div class="sect2">
<h3 id="_concurrency_atomic_libraries">17.5. Concurrency: Atomic libraries</h3>
<div class="paragraph">
<p>This chapter has discussed using polymorphism to reuse code. To solve
the Bank Account with a Vengeance problem from the beginning of the
chapter, we explored the process of extending several bank account
classes to add additional features while working hard to maintain thread
safety.</p>
</div>
<div class="paragraph">
<p>Code can be reused by extending classes with child classes or by using
instances of existing classes as fields. There is no single solution
that is best for every case. As in the bank account examples, it can be
difficult to know when to apply the <code>synchronized</code> keyword to methods.</p>
</div>
<div class="paragraph">
<p>To lessen the load on the programmer, the Java API provides a library of
atomic primitives in the<br>
<code>java.util.concurrent.atomic</code> package. These are classes with certain
operations that are guaranteed to execute atomically. For example, the
<code>AtomicInteger</code> class encapsulates the functionality of an <code>int</code>
variable with atomic accesses. One of its methods is
<code>incrementAndGet()</code>, which will atomically increment its internal value
by 1 and return the result. Recall from
<a href="chap13.html#RaceConditionProgram">Program 51</a> that even an operation as simple as
<code>++</code> is not atomic. If many different threads try to increment a single
variable, some of those increments can get lost, causing the final value
to be less than it should be.</p>
</div>
<div class="exampleblock">
<div class="title">Example 143. AtomicInteger</div>
<div class="content">
<div class="paragraph">
<p>We can use the <code>AtomicInteger</code> class to rewrite
<a href="chap13.html#RaceConditionProgram">Program 51</a> so that no race condition occurs.</p>
</div>
<div id="NoRaceConditionProgram" class="listingblock">
<div class="title">Program 78. Demonstrates the use of <code>AtomicInteger</code>.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kn">import</span> <span class="tok-nn">java.util.concurrent.atomic.*</span><span class="tok-o">;</span>
<span class="lineno"> 2 </span>
<span class="lineno"> 3 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">NoRaceCondition</span> <span class="tok-kd">extends</span> <span class="tok-n">Thread</span> <span class="tok-o">{</span>
<span class="lineno"> 4 </span>    <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-n">AtomicInteger</span> <span class="tok-n">counter</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AtomicInteger</span><span class="tok-o">();</span>
<span class="lineno"> 5 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">int</span> <span class="tok-n">THREADS</span> <span class="tok-o">=</span> <span class="tok-mi">4</span><span class="tok-o">;</span>
<span class="lineno"> 6 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">int</span> <span class="tok-n">COUNT</span> <span class="tok-o">=</span> <span class="tok-mi">1000000</span><span class="tok-o">;</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span>    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span> <span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 9 </span>        <span class="tok-n">NoRaceCondition</span><span class="tok-o">[]</span> <span class="tok-n">threads</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">NoRaceCondition</span><span class="tok-o">[</span><span class="tok-n">THREADS</span><span class="tok-o">];</span>
<span class="lineno">10 </span>        <span class="tok-k">for</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">THREADS</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">++</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno">11 </span>            <span class="tok-n">threads</span><span class="tok-o">[</span><span class="tok-n">i</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">NoRaceCondition</span><span class="tok-o">();</span>
<span class="lineno">12 </span>            <span class="tok-n">threads</span><span class="tok-o">[</span><span class="tok-n">i</span><span class="tok-o">].</span><span class="tok-na">start</span><span class="tok-o">();</span>
<span class="lineno">13 </span>        <span class="tok-o">}</span>
<span class="lineno">14 </span>        <span class="tok-k">try</span> <span class="tok-o">{</span>
<span class="lineno">15 </span>            <span class="tok-k">for</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">THREADS</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">++</span> <span class="tok-o">)</span>
<span class="lineno">16 </span>                <span class="tok-n">threads</span><span class="tok-o">[</span><span class="tok-n">i</span><span class="tok-o">].</span><span class="tok-na">join</span><span class="tok-o">();</span>
<span class="lineno">17 </span>        <span class="tok-o">}</span>
<span class="lineno">18 </span>        <span class="tok-k">catch</span><span class="tok-o">(</span> <span class="tok-n">InterruptedException</span> <span class="tok-n">e</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno">19 </span>            <span class="tok-n">e</span><span class="tok-o">.</span><span class="tok-na">printStackTrace</span><span class="tok-o">();</span>
<span class="lineno">20 </span>        <span class="tok-o">}</span>
<span class="lineno">21 </span>        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Counter:\t&quot;</span> <span class="tok-o">+</span> <span class="tok-n">counter</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">()</span> <span class="tok-o">);</span>
<span class="lineno">22 </span>    <span class="tok-o">}</span>
<span class="lineno">23 </span>
<span class="lineno">24 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">run</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno">25 </span>        <span class="tok-k">for</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">COUNT</span> <span class="tok-o">/</span> <span class="tok-n">THREADS</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">++</span> <span class="tok-o">)</span>
<span class="lineno">26 </span>            <span class="tok-n">counter</span><span class="tok-o">.</span><span class="tok-na">incrementAndGet</span><span class="tok-o">();</span>
<span class="lineno">27 </span>    <span class="tok-o">}</span>
<span class="lineno">28 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This program is identical to <a href="chap13.html#RaceConditionProgram">Program 51</a>, except
that the type of <code>counter</code> has been changed from <code>int</code> to
<code>AtomicInteger</code> (and an appropriate <code>import</code> has been added).
Consequently, the <code>++</code> operation was changed to an <code>incrementAndGet()</code>
method call, and a <code>get()</code> method call was needed to get the final
value. If you run this program, the final answer should always be
1000000, no matter what.</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#ex17-9">Exercise 17.9</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>java.util.concurrent.atomic</code> package includes <code>AtomicBoolean</code> and
<code>AtomicLong</code> as well as <code>AtomicInteger</code>. Likewise, the
<code>AtomicIntegerArray</code> and <code>AtomicLongArray</code> classes are included to
perform atomic array accesses. For general purposes, the
<code>AtomicReference&lt;V&gt;</code> class provides an atomic way to store a reference
to any object. (The <code>&lt;V&gt;</code> is a generic type parameter, which will be
discussed in <a href="chap17.html#ch18-dynamic-data-structures">Chapter 18</a>.)</p>
</div>
<div class="paragraph">
<p>Although you could use the <code>synchronized</code> keyword to create each one of
these classes yourself, the result would not be as efficient. The atomic
classes use a special <em>lock-free</em> mechanism. Unlike using the
<code>synchronized</code> keyword which forces a thread to acquire a lock on a
specific object, lock-free mechanisms are built on a <em>compare-and-swap</em>
(CAS) hardware instruction. Thus, incrementing and the handful of other
ways to update an atomic variable execute in one step because of special
instructions on the CPU. Since there is no waiting to acquire a lock or
fighting over which thread has the lock, the operation is very fast.
Many high performance concurrent applications depends on CAS
implementations.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><a href="#ex17-11">Exercise 17.11</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercises_17">17.6. Exercises</h3>
<div class="paragraph">
<p><strong>Conceptual Problems</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="ex17-1"></a> Consider the following two classes:</p>
<div id="SaleProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Sale</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-n">discount</span> <span class="tok-o">=</span> <span class="tok-mf">0.25</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-nf">getDiscount</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 5 </span>        <span class="tok-k">return</span> <span class="tok-n">discount</span><span class="tok-o">;</span>
<span class="lineno"> 6 </span>    <span class="tok-o">}</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setDiscount</span><span class="tok-o">(</span> <span class="tok-kt">double</span> <span class="tok-n">value</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 9 </span>        <span class="tok-n">discount</span> <span class="tok-o">=</span> <span class="tok-n">value</span><span class="tok-o">;</span>
<span class="lineno">10 </span>    <span class="tok-o">}</span>
<span class="lineno">11 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div id="BlowoutProgram" class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="lineno"> 1 </span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Blowout</span> <span class="tok-kd">extends</span> <span class="tok-n">Sale</span> <span class="tok-o">{</span>
<span class="lineno"> 2 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-n">discount</span> <span class="tok-o">=</span> <span class="tok-mf">0.5</span><span class="tok-o">;</span>
<span class="lineno"> 3 </span>
<span class="lineno"> 4 </span>    <span class="tok-kd">public</span> <span class="tok-kt">double</span> <span class="tok-nf">getDiscount</span><span class="tok-o">()</span> <span class="tok-o">{</span>
<span class="lineno"> 5 </span>        <span class="tok-k">return</span> <span class="tok-n">discount</span><span class="tok-o">;</span>
<span class="lineno"> 6 </span>    <span class="tok-o">}</span>
<span class="lineno"> 7 </span>
<span class="lineno"> 8 </span>    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setDiscount</span><span class="tok-o">(</span> <span class="tok-kt">double</span> <span class="tok-n">value</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
<span class="lineno"> 9 </span>        <span class="tok-n">discount</span> <span class="tok-o">=</span> <span class="tok-n">value</span><span class="tok-o">;</span>
<span class="lineno">10 </span>    <span class="tok-o">}</span>
<span class="lineno">11 </span><span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given the following snippet of code, what is the output?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Sale</span> <span class="tok-n">sale</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Blowout</span><span class="tok-o">();</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span> <span class="tok-n">sale</span><span class="tok-o">.</span><span class="tok-na">discount</span> <span class="tok-o">);</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span> <span class="tok-n">sale</span><span class="tok-o">.</span><span class="tok-na">getDiscount</span> <span class="tok-o">);</span>
<span class="tok-n">Blowout</span> <span class="tok-n">blowout</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Blowout</span><span class="tok-o">)</span><span class="tok-n">sale</span><span class="tok-o">;</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span> <span class="tok-n">blowout</span><span class="tok-o">.</span><span class="tok-na">discount</span> <span class="tok-o">);</span>
<span class="tok-n">sale</span><span class="tok-o">.</span><span class="tok-na">setDiscount</span><span class="tok-o">(</span> <span class="tok-mf">0.75</span> <span class="tok-o">);</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span> <span class="tok-n">sale</span><span class="tok-o">.</span><span class="tok-na">discount</span> <span class="tok-o">);</span></code></pre>
</div>
</div>
</li>
<li>
<p><a id="ex17-2"></a> What are the differences and similarities between abstract classes
and interfaces?</p>
</li>
<li>
<p><a id="ex17-3"></a> Assume that the <code>Corn</code>, <code>Carrot</code>, and <code>Potato</code> classes are all
derived from <code>Vegetable</code>. Both <code>Carrot</code> and <code>Potato</code> classes have a
<code>peel()</code> method, but <code>Corn</code> does not. Examine the following code and
identify which line will cause an error and why.</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Vegetable</span><span class="tok-o">[]</span> <span class="tok-n">vegetables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Vegetable</span><span class="tok-o">[</span><span class="tok-mi">30</span><span class="tok-o">];</span>
<span class="tok-k">for</span><span class="tok-o">(</span> <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">&lt;</span> <span class="tok-n">vegetables</span><span class="tok-o">.</span><span class="tok-na">length</span><span class="tok-o">;</span> <span class="tok-n">i</span> <span class="tok-o">+=</span> <span class="tok-mi">3</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">vegetables</span><span class="tok-o">[</span><span class="tok-n">i</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Corn</span><span class="tok-o">();</span>
    <span class="tok-n">vegetables</span><span class="tok-o">[</span><span class="tok-n">i</span> <span class="tok-o">+</span> <span class="tok-mi">1</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Carrot</span><span class="tok-o">();</span>
    <span class="tok-n">vegetables</span><span class="tok-o">[</span><span class="tok-n">i</span> <span class="tok-o">+</span> <span class="tok-mi">2</span><span class="tok-o">]</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Potato</span><span class="tok-o">();</span>
<span class="tok-o">}</span>
<span class="tok-kt">int</span> <span class="tok-n">index</span> <span class="tok-o">=</span> <span class="tok-n">vegetables</span><span class="tok-o">.</span><span class="tok-na">length</span> <span class="tok-o">-</span> <span class="tok-mi">1</span><span class="tok-o">;</span>
<span class="tok-n">Potato</span> <span class="tok-n">potato</span><span class="tok-o">;</span>
<span class="tok-k">while</span><span class="tok-o">(</span> <span class="tok-n">index</span> <span class="tok-o">&gt;=</span> <span class="tok-mi">0</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">potato</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Potato</span><span class="tok-o">)</span><span class="tok-n">vegetable</span><span class="tok-o">[</span><span class="tok-n">index</span><span class="tok-o">];</span>
    <span class="tok-n">potato</span><span class="tok-o">.</span><span class="tok-na">peel</span><span class="tok-o">();</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</li>
<li>
<p><a id="ex17-4"></a> How many different meanings of the keyword <code>final</code> are there in
Java, and what does each mean?</p>
</li>
<li>
<p><a id="ex17-5"></a>  Assume that <code>Quicksand</code> is a subclass of <code>Danger</code>.</p>
<div class="paragraph">
<p>What is the output of the following code?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">Quicksand</span> <span class="tok-n">quicksand</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Quicksand</span><span class="tok-o">();</span>
<span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">quicksand</span> <span class="tok-k">instanceof</span> <span class="tok-n">Danger</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">printf</span><span class="tok-o">(</span> <span class="tok-s">&quot;Run for your lives!&quot;</span> <span class="tok-o">);</span>
<span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">quicksand</span><span class="tok-o">.</span><span class="tok-na">getClass</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-n">Danger</span><span class="tok-o">.</span><span class="tok-na">class</span> <span class="tok-o">)</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">printf</span><span class="tok-o">(</span> <span class="tok-s">&quot;Run even faster!&quot;</span> <span class="tok-o">);</span>
<span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">quicksand</span> <span class="tok-k">instanceof</span> <span class="tok-n">Quicksand</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">printf</span><span class="tok-o">(</span> <span class="tok-s">&quot;The more you struggle,&quot;</span> <span class="tok-o">+</span>
    <span class="tok-s">&quot; the faster you'll sink!&quot;</span> <span class="tok-o">);</span>
<span class="tok-k">if</span><span class="tok-o">(</span> <span class="tok-n">quicksand</span><span class="tok-o">.</span><span class="tok-na">getClass</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-n">Quicksand</span><span class="tok-o">.</span><span class="tok-na">class</span> <span class="tok-o">)</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">printf</span><span class="tok-o">(</span> <span class="tok-s">&quot;You'll need to find a vine to escape!&quot;</span> <span class="tok-o">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programming Practice</strong></p>
</div>
</li>
<li>
<p><a id="ex17-6"></a> Implement a program to assess income tax on normal employees,
students, and international students using a class hierarchy. Normal
employees pay a 6.2% social security tax and a 1.45% Medicare tax every
year, but neither kind of student pays these taxes. All three groups pay
normal income tax according to the following table.</p>
<table class="tableblock frame-all grid-all fit-content center">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Marginal Tax Rate</th>
<th class="tableblock halign-center valign-top">Income Bracket</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">10%</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$0 - $7,825</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">15%</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$7,826 -$31,850</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">25%</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$31,851 -$77,100</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">28%</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$77,101- $160,850</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">33%</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$160,851- $349,700</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">35%</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$349,701+</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Tax is assessed at a given rate for every dollar in the range. For
example, if someone makes $10,000, she pays 10% tax on the first $7,825
of her income and 15% on the remaining $2,175. The exception is
international students whose country has a treaty with the U.S. so that
they do not have to pay tax on the first $50,000 of income.</p>
</div>
</li>
<li>
<p><a id="ex17-7"></a> Refer to the sort given in <a href="chap9.html#_solution_sort_it_out">Section 10.5</a> as the
solution to the Sort It Out problem. Add another <code>boolean</code> to the
parameters of the sort which specifies whether the sort is ascending or
descending. Make the needed changes throughout the code to add this
functionality.</p>
</li>
<li>
<p><a id="ex17-8"></a> Again refer to the sort from
<a href="chap9.html#_solution_sort_it_out">Section 10.5</a>. The goal now is to parallelize the
sort. Change the sort to work with <code>int</code> values then write some code
which will generate an array of random <code>int</code> values. Design your code so
that you can spawn \(n\) threads. Partition the single array
into \(n\) arrays and map one partition to each thread. Use
your bubble sort implementation to sort each partition. Finally, merge
the arrays back together, in sorted order, into one final array. For
now, just use one thread (ideally the main thread) to do the merge.</p>
<div class="paragraph">
<p>The merge operation is a simple idea, but it is easy to make mistakes in
implementation. The idea is to have three indexes, one for each of the
two arrays you are merging and one for the result array. Always take the
smaller (or larger, if sorting in descending order) index value from the
two arrays and put it in the result. Then increment the index from the
array you took the data from as well as the index of the result array.
Make sure that you are careful not to go beyond the end of the arrays
which are being merged.</p>
</div>
</li>
<li>
<p><a id="ex17-9"></a> Re-implement the original
<code>SynchronizedAccount</code> class from <a href="chap13.html#bankAccountExample">Example 107</a> using
atomic classes. For simplicity, you can change the <code>balance</code> type from
<code>double</code> to <code>AtomicInteger</code> since there is no <code>AtomicDouble</code> class. How
much has this simplified the implementation? Is the <code>readers</code> field
still necessary? Why or why not?</p>
<div class="paragraph">
<p><strong>Experiments</strong></p>
</div>
</li>
<li>
<p><a id="ex17-10"></a> Once you have implemented the sort in parallel from
<a href="#ex17-8">Exercise 17.8</a>, time it against the
sequential version. Try 2, 4, and 8 different threads, particularly if
you have 8 cores. Be sure to create one random array and use the same
array for both the parallel and sequential versions. Try array sizes of
1,000, 100,000, and 1,000,000. Did the performance increase as much as you
expect?</p>
</li>
<li>
<p><a id="ex17-11"></a> Take <a href="#NoRaceConditionProgram">Program 78</a>
and increase <code>COUNT</code> to <code>100000000</code>. Run it several times and time how
long it takes to run to completion.</p>
<div class="paragraph">
<p>Then, take <a href="chap13.html#RaceConditionProgram">Program 51</a> and increase its <code>COUNT</code> to
<code>100000000</code> as well. Change the body of the <code>for</code> loop inside the
<code>run()</code> method so that <code>count++;</code> is inside of a <code>synchronized</code> block
that uses <code>RaceCondition.class</code> as the lock. (The choice of
<code>RaceCondition.class</code> is arbitrary, but it is an object that all the
threads can see.) In this way, the increment will occur atomically,
since only the thread that has acquired the <code>RaceCondition.class</code> lock
will be able to do the operation. Now, run this modified program several
times and time it.</p>
</div>
<div class="paragraph">
<p>How different are the running times? They may be similar, depending on
the implementation of locks and CAS on your OS and hardware platform.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div></div>
<div id="footer">
<div id="footer-text">
Last updated 2018-12-03 12:18:02 EST
</div>
</div>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-129929421-1','auto');
ga('send','pageview');
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>